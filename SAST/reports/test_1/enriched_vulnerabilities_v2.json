{
  "metadata": {
    "aggregated_report": "/Users/izelikson/python/CryptoSlon/SAST/reports/first_test/aggregated_sast_report_semantic_v1.json",
    "triage_analysis": "/Users/izelikson/python/CryptoSlon/SAST/reports/first_test/triage_analysis_v5.json",
    "generated_at": "2025-08-24T00:00:00Z",
    "total_vulnerabilities": 49
  },
  "vulnerabilities": [
    {
      "cwe": "CWE-95",
      "rule_description": "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "message": "Execution of untrusted code through eval, exec, or similar functions",
      "severity": "HIGH",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 4,
      "semantic_group": "CODE_INJECTION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 217,
      "end_line": 217,
      "location_key": "/taskstate/tsapp/routes.py:217-217",
      "fix": "Убрать eval/exec; заменить на безопасные парсеры/вайтлисты, использовать явное сопоставление операций и типов данных.",
      "poc": "Передать в параметр, который попадает в eval/exec, значение: __import__('os').system('id') и получить выполнение команды (см. routes.py:217,218,258,262).",
      "risk": "HIGH – выполнение произвольного кода через eval/exec ведёт к RCE и полному захвату сервера.",
      "vulnerability_name": "Code Injection через eval/exec",
      "triage_cwe": "CWE-95 Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-95",
      "rule_description": "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "message": "Execution of untrusted code through eval, exec, or similar functions",
      "severity": "HIGH",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 4,
      "semantic_group": "CODE_INJECTION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 218,
      "end_line": 218,
      "location_key": "/taskstate/tsapp/routes.py:218-218",
      "fix": "Убрать eval/exec; заменить на безопасные парсеры/вайтлисты, использовать явное сопоставление операций и типов данных.",
      "poc": "Передать в параметр, который попадает в eval/exec, значение: __import__('os').system('id') и получить выполнение команды (см. routes.py:217,218,258,262).",
      "risk": "HIGH – выполнение произвольного кода через eval/exec ведёт к RCE и полному захвату сервера.",
      "vulnerability_name": "Code Injection через eval/exec",
      "triage_cwe": "CWE-95 Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-95",
      "rule_description": "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "message": "Execution of untrusted code through eval, exec, or similar functions",
      "severity": "HIGH",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 4,
      "semantic_group": "CODE_INJECTION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 258,
      "end_line": 258,
      "location_key": "/taskstate/tsapp/routes.py:258-258",
      "fix": "Убрать eval/exec; заменить на безопасные парсеры/вайтлисты, использовать явное сопоставление операций и типов данных.",
      "poc": "Передать в параметр, который попадает в eval/exec, значение: __import__('os').system('id') и получить выполнение команды (см. routes.py:217,218,258,262).",
      "risk": "HIGH – выполнение произвольного кода через eval/exec ведёт к RCE и полному захвату сервера.",
      "vulnerability_name": "Code Injection через eval/exec",
      "triage_cwe": "CWE-95 Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-95",
      "rule_description": "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "message": "Execution of untrusted code through eval, exec, or similar functions",
      "severity": "HIGH",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 4,
      "semantic_group": "CODE_INJECTION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 262,
      "end_line": 262,
      "location_key": "/taskstate/tsapp/routes.py:262-262",
      "fix": "Убрать eval/exec; заменить на безопасные парсеры/вайтлисты, использовать явное сопоставление операций и типов данных.",
      "poc": "Передать в параметр, который попадает в eval/exec, значение: __import__('os').system('id') и получить выполнение команды (см. routes.py:217,218,258,262).",
      "risk": "HIGH – выполнение произвольного кода через eval/exec ведёт к RCE и полному захвату сервера.",
      "vulnerability_name": "Code Injection через eval/exec",
      "triage_cwe": "CWE-95 Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-259",
      "rule_description": "Use of Hard-coded Password",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 7,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 102,
      "end_line": 102,
      "location_key": "/taskstate/tsapp/routes.py:102-102",
      "fix": "Удалить секреты из кода; хранить в переменных окружения/secret manager, внедрить ротацию и детектирование утечек в CI.",
      "poc": "Найти значения в коде (routes.py:102,123,149,173,182,486; sconfig.py:3-4) и использовать для аутентификации/подключения к сервисам.",
      "risk": "MEDIUM – утечка ключей/паролей ведёт к несанкционированному доступу; в проде риск фактически HIGH.",
      "vulnerability_name": "Хардкоды секретов и паролей в коде",
      "triage_cwe": "CWE-798/259 Use of Hard-coded Credentials/Passwords",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-259",
      "rule_description": "Use of Hard-coded Password",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 7,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 123,
      "end_line": 123,
      "location_key": "/taskstate/tsapp/routes.py:123-123",
      "fix": "Использовать криптографически стойкие одноразовые токены с истечением, связывать их с устройством/почтой, вводить rate‑limit и обязательную повторную аутентификацию.",
      "poc": "Инициировать восстановление и перебрать/предсказать код/токен подтверждения из ограниченного пространства (см. routes.py:120-196; func.py:37). Отсутствие rate‑limit/подтверждения e‑mail упрощает атаку.",
      "risk": "HIGH – позволяет перехватить/сбросить пароль жертвы через предсказуемый/несекурный токен или без достаточной верификации.",
      "vulnerability_name": "Слабый механизм восстановления пароля",
      "triage_cwe": "CWE-640 Weak Password Recovery Mechanism for Forgotten Password",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-259",
      "rule_description": "Use of Hard-coded Password",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 7,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 149,
      "end_line": 149,
      "location_key": "/taskstate/tsapp/routes.py:149-149",
      "fix": "Использовать криптографически стойкие одноразовые токены с истечением, связывать их с устройством/почтой, вводить rate‑limit и обязательную повторную аутентификацию.",
      "poc": "Инициировать восстановление и перебрать/предсказать код/токен подтверждения из ограниченного пространства (см. routes.py:120-196; func.py:37). Отсутствие rate‑limit/подтверждения e‑mail упрощает атаку.",
      "risk": "HIGH – позволяет перехватить/сбросить пароль жертвы через предсказуемый/несекурный токен или без достаточной верификации.",
      "vulnerability_name": "Слабый механизм восстановления пароля",
      "triage_cwe": "CWE-640 Weak Password Recovery Mechanism for Forgotten Password",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-259",
      "rule_description": "Use of Hard-coded Password",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 7,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 173,
      "end_line": 173,
      "location_key": "/taskstate/tsapp/routes.py:173-173",
      "fix": "Использовать криптографически стойкие одноразовые токены с истечением, связывать их с устройством/почтой, вводить rate‑limit и обязательную повторную аутентификацию.",
      "poc": "Инициировать восстановление и перебрать/предсказать код/токен подтверждения из ограниченного пространства (см. routes.py:120-196; func.py:37). Отсутствие rate‑limit/подтверждения e‑mail упрощает атаку.",
      "risk": "HIGH – позволяет перехватить/сбросить пароль жертвы через предсказуемый/несекурный токен или без достаточной верификации.",
      "vulnerability_name": "Слабый механизм восстановления пароля",
      "triage_cwe": "CWE-640 Weak Password Recovery Mechanism for Forgotten Password",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-259",
      "rule_description": "Use of Hard-coded Password",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 7,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 182,
      "end_line": 182,
      "location_key": "/taskstate/tsapp/routes.py:182-182",
      "fix": "Использовать криптографически стойкие одноразовые токены с истечением, связывать их с устройством/почтой, вводить rate‑limit и обязательную повторную аутентификацию.",
      "poc": "Инициировать восстановление и перебрать/предсказать код/токен подтверждения из ограниченного пространства (см. routes.py:120-196; func.py:37). Отсутствие rate‑limit/подтверждения e‑mail упрощает атаку.",
      "risk": "HIGH – позволяет перехватить/сбросить пароль жертвы через предсказуемый/несекурный токен или без достаточной верификации.",
      "vulnerability_name": "Слабый механизм восстановления пароля",
      "triage_cwe": "CWE-640 Weak Password Recovery Mechanism for Forgotten Password",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-259",
      "rule_description": "Use of Hard-coded Password",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 7,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 486,
      "end_line": 486,
      "location_key": "/taskstate/tsapp/routes.py:486-486",
      "fix": "",
      "poc": "",
      "risk": "MEDIUM - No detailed risk analysis available",
      "vulnerability_name": "Use of Hard-coded Password",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-259",
      "rule_description": "Use of Hard-coded Password",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 7,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/sconfig.py",
      "start_line": 3,
      "end_line": 3,
      "location_key": "/taskstate/tsapp/sconfig.py:3-3",
      "fix": "Удалить секреты из кода; хранить в переменных окружения/secret manager, внедрить ротацию и детектирование утечек в CI.",
      "poc": "Найти значения в коде (routes.py:102,123,149,173,182,486; sconfig.py:3-4) и использовать для аутентификации/подключения к сервисам.",
      "risk": "MEDIUM – утечка ключей/паролей ведёт к несанкционированному доступу; в проде риск фактически HIGH.",
      "vulnerability_name": "Хардкоды секретов и паролей в коде",
      "triage_cwe": "CWE-798/259 Use of Hard-coded Credentials/Passwords",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-259",
      "rule_description": "Use of Hard-coded Password",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 7,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/sconfig.py",
      "start_line": 4,
      "end_line": 4,
      "location_key": "/taskstate/tsapp/sconfig.py:4-4",
      "fix": "Удалить секреты из кода; хранить в переменных окружения/secret manager, внедрить ротацию и детектирование утечек в CI.",
      "poc": "Найти значения в коде (routes.py:102,123,149,173,182,486; sconfig.py:3-4) и использовать для аутентификации/подключения к сервисам.",
      "risk": "MEDIUM – утечка ключей/паролей ведёт к несанкционированному доступу; в проде риск фактически HIGH.",
      "vulnerability_name": "Хардкоды секретов и паролей в коде",
      "triage_cwe": "CWE-798/259 Use of Hard-coded Credentials/Passwords",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-798",
      "rule_description": "Use of Hard-coded Credentials",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 2,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 102,
      "end_line": 102,
      "location_key": "/taskstate/tsapp/routes.py:102-102",
      "fix": "Удалить секреты из кода; хранить в переменных окружения/secret manager, внедрить ротацию и детектирование утечек в CI.",
      "poc": "Найти значения в коде (routes.py:102,123,149,173,182,486; sconfig.py:3-4) и использовать для аутентификации/подключения к сервисам.",
      "risk": "MEDIUM – утечка ключей/паролей ведёт к несанкционированному доступу; в проде риск фактически HIGH.",
      "vulnerability_name": "Хардкоды секретов и паролей в коде",
      "triage_cwe": "CWE-798/259 Use of Hard-coded Credentials/Passwords",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-798",
      "rule_description": "Use of Hard-coded Credentials",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 2,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 123,
      "end_line": 123,
      "location_key": "/taskstate/tsapp/routes.py:123-123",
      "fix": "Использовать криптографически стойкие одноразовые токены с истечением, связывать их с устройством/почтой, вводить rate‑limit и обязательную повторную аутентификацию.",
      "poc": "Инициировать восстановление и перебрать/предсказать код/токен подтверждения из ограниченного пространства (см. routes.py:120-196; func.py:37). Отсутствие rate‑limit/подтверждения e‑mail упрощает атаку.",
      "risk": "HIGH – позволяет перехватить/сбросить пароль жертвы через предсказуемый/несекурный токен или без достаточной верификации.",
      "vulnerability_name": "Слабый механизм восстановления пароля",
      "triage_cwe": "CWE-640 Weak Password Recovery Mechanism for Forgotten Password",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-798",
      "rule_description": "Use of Hard-coded Credentials",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 2,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 149,
      "end_line": 149,
      "location_key": "/taskstate/tsapp/routes.py:149-149",
      "fix": "Использовать криптографически стойкие одноразовые токены с истечением, связывать их с устройством/почтой, вводить rate‑limit и обязательную повторную аутентификацию.",
      "poc": "Инициировать восстановление и перебрать/предсказать код/токен подтверждения из ограниченного пространства (см. routes.py:120-196; func.py:37). Отсутствие rate‑limit/подтверждения e‑mail упрощает атаку.",
      "risk": "HIGH – позволяет перехватить/сбросить пароль жертвы через предсказуемый/несекурный токен или без достаточной верификации.",
      "vulnerability_name": "Слабый механизм восстановления пароля",
      "triage_cwe": "CWE-640 Weak Password Recovery Mechanism for Forgotten Password",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-798",
      "rule_description": "Use of Hard-coded Credentials",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 2,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 173,
      "end_line": 173,
      "location_key": "/taskstate/tsapp/routes.py:173-173",
      "fix": "Использовать криптографически стойкие одноразовые токены с истечением, связывать их с устройством/почтой, вводить rate‑limit и обязательную повторную аутентификацию.",
      "poc": "Инициировать восстановление и перебрать/предсказать код/токен подтверждения из ограниченного пространства (см. routes.py:120-196; func.py:37). Отсутствие rate‑limit/подтверждения e‑mail упрощает атаку.",
      "risk": "HIGH – позволяет перехватить/сбросить пароль жертвы через предсказуемый/несекурный токен или без достаточной верификации.",
      "vulnerability_name": "Слабый механизм восстановления пароля",
      "triage_cwe": "CWE-640 Weak Password Recovery Mechanism for Forgotten Password",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-798",
      "rule_description": "Use of Hard-coded Credentials",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 2,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 182,
      "end_line": 182,
      "location_key": "/taskstate/tsapp/routes.py:182-182",
      "fix": "Использовать криптографически стойкие одноразовые токены с истечением, связывать их с устройством/почтой, вводить rate‑limit и обязательную повторную аутентификацию.",
      "poc": "Инициировать восстановление и перебрать/предсказать код/токен подтверждения из ограниченного пространства (см. routes.py:120-196; func.py:37). Отсутствие rate‑limit/подтверждения e‑mail упрощает атаку.",
      "risk": "HIGH – позволяет перехватить/сбросить пароль жертвы через предсказуемый/несекурный токен или без достаточной верификации.",
      "vulnerability_name": "Слабый механизм восстановления пароля",
      "triage_cwe": "CWE-640 Weak Password Recovery Mechanism for Forgotten Password",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-798",
      "rule_description": "Use of Hard-coded Credentials",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 2,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 486,
      "end_line": 486,
      "location_key": "/taskstate/tsapp/routes.py:486-486",
      "fix": "",
      "poc": "",
      "risk": "MEDIUM - No detailed risk analysis available",
      "vulnerability_name": "Use of Hard-coded Credentials",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-798",
      "rule_description": "Use of Hard-coded Credentials",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 2,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/sconfig.py",
      "start_line": 3,
      "end_line": 3,
      "location_key": "/taskstate/tsapp/sconfig.py:3-3",
      "fix": "Удалить секреты из кода; хранить в переменных окружения/secret manager, внедрить ротацию и детектирование утечек в CI.",
      "poc": "Найти значения в коде (routes.py:102,123,149,173,182,486; sconfig.py:3-4) и использовать для аутентификации/подключения к сервисам.",
      "risk": "MEDIUM – утечка ключей/паролей ведёт к несанкционированному доступу; в проде риск фактически HIGH.",
      "vulnerability_name": "Хардкоды секретов и паролей в коде",
      "triage_cwe": "CWE-798/259 Use of Hard-coded Credentials/Passwords",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-798",
      "rule_description": "Use of Hard-coded Credentials",
      "message": "Hard-coded passwords, API keys, or other sensitive credentials in source code",
      "severity": "MEDIUM",
      "sources": [
        "bandit",
        "semgrep"
      ],
      "count": 2,
      "semantic_group": "SECRETS",
      "file_path": "/taskstate/tsapp/sconfig.py",
      "start_line": 4,
      "end_line": 4,
      "location_key": "/taskstate/tsapp/sconfig.py:4-4",
      "fix": "Удалить секреты из кода; хранить в переменных окружения/secret manager, внедрить ротацию и детектирование утечек в CI.",
      "poc": "Найти значения в коде (routes.py:102,123,149,173,182,486; sconfig.py:3-4) и использовать для аутентификации/подключения к сервисам.",
      "risk": "MEDIUM – утечка ключей/паролей ведёт к несанкционированному доступу; в проде риск фактически HIGH.",
      "vulnerability_name": "Хардкоды секретов и паролей в коде",
      "triage_cwe": "CWE-798/259 Use of Hard-coded Credentials/Passwords",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-532",
      "rule_description": "Insertion of Sensitive Information into Log File",
      "message": "Exposure of sensitive information through logs or unauthorized access",
      "severity": "MEDIUM",
      "sources": [
        "semgrep"
      ],
      "count": 5,
      "semantic_group": "SENSITIVE_DATA_EXPOSURE",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 113,
      "end_line": 113,
      "location_key": "/taskstate/tsapp/routes.py:113-113",
      "fix": "",
      "poc": "",
      "risk": "MEDIUM - No detailed risk analysis available",
      "vulnerability_name": "Insertion of Sensitive Information into Log File",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-532",
      "rule_description": "Insertion of Sensitive Information into Log File",
      "message": "Exposure of sensitive information through logs or unauthorized access",
      "severity": "MEDIUM",
      "sources": [
        "semgrep"
      ],
      "count": 5,
      "semantic_group": "SENSITIVE_DATA_EXPOSURE",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 174,
      "end_line": 174,
      "location_key": "/taskstate/tsapp/routes.py:174-174",
      "fix": "Использовать криптографически стойкие одноразовые токены с истечением, связывать их с устройством/почтой, вводить rate‑limit и обязательную повторную аутентификацию.",
      "poc": "Инициировать восстановление и перебрать/предсказать код/токен подтверждения из ограниченного пространства (см. routes.py:120-196; func.py:37). Отсутствие rate‑limit/подтверждения e‑mail упрощает атаку.",
      "risk": "HIGH – позволяет перехватить/сбросить пароль жертвы через предсказуемый/несекурный токен или без достаточной верификации.",
      "vulnerability_name": "Слабый механизм восстановления пароля",
      "triage_cwe": "CWE-640 Weak Password Recovery Mechanism for Forgotten Password",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-532",
      "rule_description": "Insertion of Sensitive Information into Log File",
      "message": "Exposure of sensitive information through logs or unauthorized access",
      "severity": "MEDIUM",
      "sources": [
        "semgrep"
      ],
      "count": 5,
      "semantic_group": "SENSITIVE_DATA_EXPOSURE",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 186,
      "end_line": 186,
      "location_key": "/taskstate/tsapp/routes.py:186-186",
      "fix": "Использовать криптографически стойкие одноразовые токены с истечением, связывать их с устройством/почтой, вводить rate‑limit и обязательную повторную аутентификацию.",
      "poc": "Инициировать восстановление и перебрать/предсказать код/токен подтверждения из ограниченного пространства (см. routes.py:120-196; func.py:37). Отсутствие rate‑limit/подтверждения e‑mail упрощает атаку.",
      "risk": "HIGH – позволяет перехватить/сбросить пароль жертвы через предсказуемый/несекурный токен или без достаточной верификации.",
      "vulnerability_name": "Слабый механизм восстановления пароля",
      "triage_cwe": "CWE-640 Weak Password Recovery Mechanism for Forgotten Password",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-532",
      "rule_description": "Insertion of Sensitive Information into Log File",
      "message": "Exposure of sensitive information through logs or unauthorized access",
      "severity": "MEDIUM",
      "sources": [
        "semgrep"
      ],
      "count": 5,
      "semantic_group": "SENSITIVE_DATA_EXPOSURE",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 497,
      "end_line": 497,
      "location_key": "/taskstate/tsapp/routes.py:497-497",
      "fix": "",
      "poc": "",
      "risk": "MEDIUM - No detailed risk analysis available",
      "vulnerability_name": "Insertion of Sensitive Information into Log File",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-532",
      "rule_description": "Insertion of Sensitive Information into Log File",
      "message": "Exposure of sensitive information through logs or unauthorized access",
      "severity": "MEDIUM",
      "sources": [
        "semgrep"
      ],
      "count": 5,
      "semantic_group": "SENSITIVE_DATA_EXPOSURE",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 77,
      "end_line": 77,
      "location_key": "/taskstate/tsapp/routes.py:77-77",
      "fix": "",
      "poc": "",
      "risk": "MEDIUM - No detailed risk analysis available",
      "vulnerability_name": "Insertion of Sensitive Information into Log File",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/app.py",
      "start_line": 14,
      "end_line": 17,
      "location_key": "/taskstate/app.py:14-17",
      "fix": "Явно внедрить декораторы @login_required/@roles_required и централизованные проверки ACL перед любыми чувствительными действиями; добавить unit/integ‑тесты на отказ без привилегий.",
      "poc": "Обратиться к одному из эндпоинтов с админ‑функцией без токена/сессии (см. routes.py:416-451) и получить 200/успешный результат; либо вручную изменить роль/идентификатор в запросе/сессии и вызвать операции изменения ролей (routes.py:458-473).",
      "risk": "HIGH – множество (21) мест без корректных проверок доступа позволяет горизонтальную/вертикальную эскалацию привилегий.",
      "vulnerability_name": "Неправильное управление привилегиями в маршрутах",
      "triage_cwe": "CWE-269 Improper Privilege Management",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/func.py",
      "start_line": 24,
      "end_line": 25,
      "location_key": "/taskstate/tsapp/func.py:24-25",
      "fix": "",
      "poc": "",
      "risk": "HIGH - No detailed risk analysis available",
      "vulnerability_name": "Improper Privilege Management",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/func.py",
      "start_line": 26,
      "end_line": 28,
      "location_key": "/taskstate/tsapp/func.py:26-28",
      "fix": "",
      "poc": "",
      "risk": "HIGH - No detailed risk analysis available",
      "vulnerability_name": "Improper Privilege Management",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/func.py",
      "start_line": 29,
      "end_line": 31,
      "location_key": "/taskstate/tsapp/func.py:29-31",
      "fix": "",
      "poc": "",
      "risk": "HIGH - No detailed risk analysis available",
      "vulnerability_name": "Improper Privilege Management",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/func.py",
      "start_line": 30,
      "end_line": 31,
      "location_key": "/taskstate/tsapp/func.py:30-31",
      "fix": "",
      "poc": "",
      "risk": "HIGH - No detailed risk analysis available",
      "vulnerability_name": "Improper Privilege Management",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 201,
      "end_line": 202,
      "location_key": "/taskstate/tsapp/routes.py:201-202",
      "fix": "",
      "poc": "",
      "risk": "HIGH - No detailed risk analysis available",
      "vulnerability_name": "Improper Privilege Management",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 216,
      "end_line": 232,
      "location_key": "/taskstate/tsapp/routes.py:216-232",
      "fix": "Убрать eval/exec; заменить на безопасные парсеры/вайтлисты, использовать явное сопоставление операций и типов данных.",
      "poc": "Передать в параметр, который попадает в eval/exec, значение: __import__('os').system('id') и получить выполнение команды (см. routes.py:217,218,258,262).",
      "risk": "HIGH – выполнение произвольного кода через eval/exec ведёт к RCE и полному захвату сервера.",
      "vulnerability_name": "Code Injection через eval/exec",
      "triage_cwe": "CWE-95 Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 257,
      "end_line": 275,
      "location_key": "/taskstate/tsapp/routes.py:257-275",
      "fix": "Убрать eval/exec; заменить на безопасные парсеры/вайтлисты, использовать явное сопоставление операций и типов данных.",
      "poc": "Передать в параметр, который попадает в eval/exec, значение: __import__('os').system('id') и получить выполнение команды (см. routes.py:217,218,258,262).",
      "risk": "HIGH – выполнение произвольного кода через eval/exec ведёт к RCE и полному захвату сервера.",
      "vulnerability_name": "Code Injection через eval/exec",
      "triage_cwe": "CWE-95 Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 303,
      "end_line": 304,
      "location_key": "/taskstate/tsapp/routes.py:303-304",
      "fix": "",
      "poc": "",
      "risk": "HIGH - No detailed risk analysis available",
      "vulnerability_name": "Improper Privilege Management",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 305,
      "end_line": 306,
      "location_key": "/taskstate/tsapp/routes.py:305-306",
      "fix": "",
      "poc": "",
      "risk": "HIGH - No detailed risk analysis available",
      "vulnerability_name": "Improper Privilege Management",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 307,
      "end_line": 308,
      "location_key": "/taskstate/tsapp/routes.py:307-308",
      "fix": "",
      "poc": "",
      "risk": "HIGH - No detailed risk analysis available",
      "vulnerability_name": "Improper Privilege Management",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 398,
      "end_line": 399,
      "location_key": "/taskstate/tsapp/routes.py:398-399",
      "fix": "",
      "poc": "",
      "risk": "HIGH - No detailed risk analysis available",
      "vulnerability_name": "Improper Privilege Management",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 400,
      "end_line": 401,
      "location_key": "/taskstate/tsapp/routes.py:400-401",
      "fix": "",
      "poc": "",
      "risk": "HIGH - No detailed risk analysis available",
      "vulnerability_name": "Improper Privilege Management",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 402,
      "end_line": 403,
      "location_key": "/taskstate/tsapp/routes.py:402-403",
      "fix": "",
      "poc": "",
      "risk": "HIGH - No detailed risk analysis available",
      "vulnerability_name": "Improper Privilege Management",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 416,
      "end_line": 429,
      "location_key": "/taskstate/tsapp/routes.py:416-429",
      "fix": "Явно внедрить декораторы @login_required/@roles_required и централизованные проверки ACL перед любыми чувствительными действиями; добавить unit/integ‑тесты на отказ без привилегий.",
      "poc": "Обратиться к одному из эндпоинтов с админ‑функцией без токена/сессии (см. routes.py:416-451) и получить 200/успешный результат; либо вручную изменить роль/идентификатор в запросе/сессии и вызвать операции изменения ролей (routes.py:458-473).",
      "risk": "HIGH – множество (21) мест без корректных проверок доступа позволяет горизонтальную/вертикальную эскалацию привилегий.",
      "vulnerability_name": "Неправильное управление привилегиями в маршрутах",
      "triage_cwe": "CWE-269 Improper Privilege Management",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 423,
      "end_line": 429,
      "location_key": "/taskstate/tsapp/routes.py:423-429",
      "fix": "Явно внедрить декораторы @login_required/@roles_required и централизованные проверки ACL перед любыми чувствительными действиями; добавить unit/integ‑тесты на отказ без привилегий.",
      "poc": "Обратиться к одному из эндпоинтов с админ‑функцией без токена/сессии (см. routes.py:416-451) и получить 200/успешный результат; либо вручную изменить роль/идентификатор в запросе/сессии и вызвать операции изменения ролей (routes.py:458-473).",
      "risk": "HIGH – множество (21) мест без корректных проверок доступа позволяет горизонтальную/вертикальную эскалацию привилегий.",
      "vulnerability_name": "Неправильное управление привилегиями в маршрутах",
      "triage_cwe": "CWE-269 Improper Privilege Management",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 436,
      "end_line": 451,
      "location_key": "/taskstate/tsapp/routes.py:436-451",
      "fix": "Явно внедрить декораторы @login_required/@roles_required и централизованные проверки ACL перед любыми чувствительными действиями; добавить unit/integ‑тесты на отказ без привилегий.",
      "poc": "Обратиться к одному из эндпоинтов с админ‑функцией без токена/сессии (см. routes.py:416-451) и получить 200/успешный результат; либо вручную изменить роль/идентификатор в запросе/сессии и вызвать операции изменения ролей (routes.py:458-473).",
      "risk": "HIGH – множество (21) мест без корректных проверок доступа позволяет горизонтальную/вертикальную эскалацию привилегий.",
      "vulnerability_name": "Неправильное управление привилегиями в маршрутах",
      "triage_cwe": "CWE-269 Improper Privilege Management",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 458,
      "end_line": 473,
      "location_key": "/taskstate/tsapp/routes.py:458-473",
      "fix": "",
      "poc": "",
      "risk": "HIGH - No detailed risk analysis available",
      "vulnerability_name": "Improper Privilege Management",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 479,
      "end_line": 501,
      "location_key": "/taskstate/tsapp/routes.py:479-501",
      "fix": "",
      "poc": "",
      "risk": "HIGH - No detailed risk analysis available",
      "vulnerability_name": "Improper Privilege Management",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 65,
      "end_line": 80,
      "location_key": "/taskstate/tsapp/routes.py:65-80",
      "fix": "",
      "poc": "",
      "risk": "HIGH - No detailed risk analysis available",
      "vulnerability_name": "Improper Privilege Management",
      "triage_cwe": "",
      "has_triage_data": false
    },
    {
      "cwe": "CWE-269",
      "rule_description": "Improper Privilege Management",
      "message": "Improper privilege management and access control issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 21,
      "semantic_group": "PRIVILEGE_ESCALATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 95,
      "end_line": 117,
      "location_key": "/taskstate/tsapp/routes.py:95-117",
      "fix": "Удалить секреты из кода; хранить в переменных окружения/secret manager, внедрить ротацию и детектирование утечек в CI.",
      "poc": "Найти значения в коде (routes.py:102,123,149,173,182,486; sconfig.py:3-4) и использовать для аутентификации/подключения к сервисам.",
      "risk": "MEDIUM – утечка ключей/паролей ведёт к несанкционированному доступу; в проде риск фактически HIGH.",
      "vulnerability_name": "Хардкоды секретов и паролей в коде",
      "triage_cwe": "CWE-798/259 Use of Hard-coded Credentials/Passwords",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-640",
      "rule_description": "Weak Password Recovery Mechanism for Forgotten Password",
      "message": "Weak password recovery mechanisms and session management issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 2,
      "semantic_group": "WEAK_AUTHENTICATION",
      "file_path": "/taskstate/tsapp/func.py",
      "start_line": 37,
      "end_line": 37,
      "location_key": "/taskstate/tsapp/func.py:37-37",
      "fix": "Использовать криптографически стойкие одноразовые токены с истечением, связывать их с устройством/почтой, вводить rate‑limit и обязательную повторную аутентификацию.",
      "poc": "Инициировать восстановление и перебрать/предсказать код/токен подтверждения из ограниченного пространства (см. routes.py:120-196; func.py:37). Отсутствие rate‑limit/подтверждения e‑mail упрощает атаку.",
      "risk": "HIGH – позволяет перехватить/сбросить пароль жертвы через предсказуемый/несекурный токен или без достаточной верификации.",
      "vulnerability_name": "Слабый механизм восстановления пароля",
      "triage_cwe": "CWE-640 Weak Password Recovery Mechanism for Forgotten Password",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-640",
      "rule_description": "Weak Password Recovery Mechanism for Forgotten Password",
      "message": "Weak password recovery mechanisms and session management issues",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 2,
      "semantic_group": "WEAK_AUTHENTICATION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 120,
      "end_line": 196,
      "location_key": "/taskstate/tsapp/routes.py:120-196",
      "fix": "Использовать криптографически стойкие одноразовые токены с истечением, связывать их с устройством/почтой, вводить rate‑limit и обязательную повторную аутентификацию.",
      "poc": "Инициировать восстановление и перебрать/предсказать код/токен подтверждения из ограниченного пространства (см. routes.py:120-196; func.py:37). Отсутствие rate‑limit/подтверждения e‑mail упрощает атаку.",
      "risk": "HIGH – позволяет перехватить/сбросить пароль жертвы через предсказуемый/несекурный токен или без достаточной верификации.",
      "vulnerability_name": "Слабый механизм восстановления пароля",
      "triage_cwe": "CWE-640 Weak Password Recovery Mechanism for Forgotten Password",
      "has_triage_data": true
    },
    {
      "cwe": "CWE-1336",
      "rule_description": "Improper Neutralization of Special Elements Used in a Template Engine",
      "message": "Server-side template injection vulnerabilities",
      "severity": "HIGH",
      "sources": [
        "semgrep"
      ],
      "count": 1,
      "semantic_group": "TEMPLATE_INJECTION",
      "file_path": "/taskstate/tsapp/routes.py",
      "start_line": 405,
      "end_line": 405,
      "location_key": "/taskstate/tsapp/routes.py:405-405",
      "fix": "Никогда не передавать непроверенный ввод в render_template_string; экранировать данные, включить sandbox/jinja2.StrictUndefined и использовать белые списки полей.",
      "poc": "Передать {{7*7}} в поле/параметр, который шаблон отрисовывает напрямую (см. routes.py:405). В ответе появится 49; далее возможна эскалация к RCE.",
      "risk": "HIGH – SSTI часто эскалирует до RCE через доступ к объектам/OS.",
      "vulnerability_name": "Server-Side Template Injection (SSTI)",
      "triage_cwe": "CWE-1336 Improper Neutralization of Special Elements Used in a Template Engine",
      "has_triage_data": true
    }
  ]
}