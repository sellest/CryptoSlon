{
  "metadata": {
    "semgrep_file": "/Users/izelikson/python/CryptoSlon/SAST/reports/test_11/semgrep_report.sarif",
    "bandit_file": "/Users/izelikson/python/CryptoSlon/SAST/reports/test_11/bandit_report.sarif",
    "generated_at": "2025-08-24T00:00:00Z"
  },
  "summary": {
    "total_findings": 186,
    "both_tools": 11,
    "semgrep_only": 175,
    "bandit_only": 0,
    "coverage": {
      "both_percentage": 5.913978494623656,
      "agreement_rate": 5.913978494623656
    }
  },
  "findings": {
    "both": [
      {
        "category": "both",
        "location_key": "/taskstate_10/tsapp/routes.py:218-218",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 218,
        "end_line": 218,
        "snippet": "            task = TS_Task(did=int(request.form['did']), title=request.form['title'], description=request.form['description'], private=eval(request.form['private']), uid1=current_user.id, uid2=-1)",
        "semgrep": {
          "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.python-eval-exec-taint-enhanced",
          "rule_description": "",
          "message": "Code injection vulnerability: eval/exec with user input. Never pass request.* values to eval/exec. Use ast.literal_eval() for safe parsing.\n",
          "severity": "LOW",
          "snippet": "            task = TS_Task(did=int(request.form['did']), title=request.form['title'], description=request.form['description'], private=eval(request.form['private']), uid1=current_user.id, uid2=-1)"
        },
        "bandit": {
          "rule_id": "CWE-95",
          "rule_description": "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
          "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
          "severity": "HIGH",
          "snippet": "            task = TS_Task(did=int(request.form['did']), title=request.form['title'], description=request.form['description'], private=eval(request.form['private']), uid1=current_user.id, uid2=-1)\n"
        }
      },
      {
        "category": "both",
        "location_key": "/taskstate_10/tsapp/routes.py:258-258",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 258,
        "end_line": 258,
        "snippet": "            if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):",
        "semgrep": {
          "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.python-eval-exec-taint-enhanced",
          "rule_description": "",
          "message": "Code injection vulnerability: eval/exec with user input. Never pass request.* values to eval/exec. Use ast.literal_eval() for safe parsing.\n",
          "severity": "LOW",
          "snippet": "            if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):"
        },
        "bandit": {
          "rule_id": "CWE-95",
          "rule_description": "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
          "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
          "severity": "HIGH",
          "snippet": "            if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):\n"
        }
      },
      {
        "category": "both",
        "location_key": "/taskstate_10/tsapp/routes.py:149-149",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 149,
        "end_line": 149,
        "snippet": "                token_data = \"\"",
        "semgrep": {
          "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
          "rule_description": "",
          "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
          "severity": "LOW",
          "snippet": "                token_data = \"\""
        },
        "bandit": {
          "rule_id": "CWE-259",
          "rule_description": "Use of Hard-coded Password",
          "message": "Possible hardcoded password: ''",
          "severity": "MEDIUM",
          "snippet": "                token_data = \"\"\n"
        }
      },
      {
        "category": "both",
        "location_key": "/taskstate_10/tsapp/routes.py:173-173",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 173,
        "end_line": 173,
        "snippet": "                token_data = \"\"",
        "semgrep": {
          "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
          "rule_description": "",
          "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
          "severity": "LOW",
          "snippet": "                token_data = \"\""
        },
        "bandit": {
          "rule_id": "CWE-259",
          "rule_description": "Use of Hard-coded Password",
          "message": "Possible hardcoded password: ''",
          "severity": "MEDIUM",
          "snippet": "                token_data = \"\"\n"
        }
      },
      {
        "category": "both",
        "location_key": "/taskstate_10/tsapp/sconfig.py:3-3",
        "file_path": "/taskstate_10/tsapp/sconfig.py",
        "start_line": 3,
        "end_line": 3,
        "snippet": "SECRET_KEY = 'CTF-2#SecretKey'",
        "semgrep": {
          "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
          "rule_description": "",
          "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
          "severity": "LOW",
          "snippet": "SECRET_KEY = 'CTF-2#SecretKey'"
        },
        "bandit": {
          "rule_id": "CWE-259",
          "rule_description": "Use of Hard-coded Password",
          "message": "Possible hardcoded password: 'CTF-2#SecretKey'",
          "severity": "MEDIUM",
          "snippet": "SECRET_KEY = 'CTF-2#SecretKey'\n"
        }
      },
      {
        "category": "both",
        "location_key": "/taskstate_10/tsapp/routes.py:262-262",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 262,
        "end_line": 262,
        "snippet": "                task.private = eval(request.form['private'])",
        "semgrep": {
          "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.python-eval-exec-taint-enhanced",
          "rule_description": "",
          "message": "Code injection vulnerability: eval/exec with user input. Never pass request.* values to eval/exec. Use ast.literal_eval() for safe parsing.\n",
          "severity": "LOW",
          "snippet": "                task.private = eval(request.form['private'])"
        },
        "bandit": {
          "rule_id": "CWE-95",
          "rule_description": "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
          "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
          "severity": "HIGH",
          "snippet": "                task.private = eval(request.form['private'])\n"
        }
      },
      {
        "category": "both",
        "location_key": "/taskstate_10/tsapp/routes.py:486-486",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 486,
        "end_line": 486,
        "snippet": "            user = TS_User(login=ulogin, password=generate_password_hash(upassword), email=request.form['email'], rid=2, token=\"\")",
        "semgrep": {
          "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
          "rule_description": "",
          "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
          "severity": "LOW",
          "snippet": "            user = TS_User(login=ulogin, password=generate_password_hash(upassword), email=request.form['email'], rid=2, token=\"\")"
        },
        "bandit": {
          "rule_id": "CWE-259",
          "rule_description": "Use of Hard-coded Password",
          "message": "Possible hardcoded password: ''",
          "severity": "MEDIUM",
          "snippet": "            user = TS_User(login=ulogin, password=generate_password_hash(upassword), email=request.form['email'], rid=2, token=\"\")\n"
        }
      },
      {
        "category": "both",
        "location_key": "/taskstate_10/tsapp/routes.py:123-123",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 123,
        "end_line": 123,
        "snippet": "    token = \"\"",
        "semgrep": {
          "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
          "rule_description": "",
          "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
          "severity": "LOW",
          "snippet": "    token = \"\""
        },
        "bandit": {
          "rule_id": "CWE-259",
          "rule_description": "Use of Hard-coded Password",
          "message": "Possible hardcoded password: ''",
          "severity": "MEDIUM",
          "snippet": "    token = \"\"\n"
        }
      },
      {
        "category": "both",
        "location_key": "/taskstate_10/tsapp/routes.py:182-182",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 182,
        "end_line": 182,
        "snippet": "                    user.token = \"\"",
        "semgrep": {
          "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
          "rule_description": "",
          "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
          "severity": "LOW",
          "snippet": "                    user.token = \"\""
        },
        "bandit": {
          "rule_id": "CWE-259",
          "rule_description": "Use of Hard-coded Password",
          "message": "Possible hardcoded password: ''",
          "severity": "MEDIUM",
          "snippet": "                    user.token = \"\"\n"
        }
      },
      {
        "category": "both",
        "location_key": "/taskstate_10/tsapp/routes.py:102-102",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 102,
        "end_line": 102,
        "snippet": "            user = TS_User(login=ulogin, password=generate_password_hash(upassword), email=request.form['email'], rid=0, token=\"\")",
        "semgrep": {
          "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
          "rule_description": "",
          "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
          "severity": "LOW",
          "snippet": "            user = TS_User(login=ulogin, password=generate_password_hash(upassword), email=request.form['email'], rid=0, token=\"\")"
        },
        "bandit": {
          "rule_id": "CWE-259",
          "rule_description": "Use of Hard-coded Password",
          "message": "Possible hardcoded password: ''",
          "severity": "MEDIUM",
          "snippet": "            user = TS_User(login=ulogin, password=generate_password_hash(upassword), email=request.form['email'], rid=0, token=\"\")\n"
        }
      },
      {
        "category": "both",
        "location_key": "/taskstate_10/tsapp/routes.py:217-217",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 217,
        "end_line": 217,
        "snippet": "        if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):",
        "semgrep": {
          "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.python-eval-exec-taint-enhanced",
          "rule_description": "",
          "message": "Code injection vulnerability: eval/exec with user input. Never pass request.* values to eval/exec. Use ast.literal_eval() for safe parsing.\n",
          "severity": "LOW",
          "snippet": "        if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):"
        },
        "bandit": {
          "rule_id": "CWE-95",
          "rule_description": "Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
          "message": "Use of possibly insecure function - consider using safer ast.literal_eval.",
          "severity": "HIGH",
          "snippet": "        if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):\n"
        }
      }
    ],
    "semgrep": [
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:162-162",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 162,
        "end_line": 162,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.logging-sensitive-data-enhanced",
        "rule_description": "",
        "message": "Information disclosure (CWE-532): Logging potentially sensitive data. Avoid logging passwords, tokens, or personal information.\n",
        "severity": "LOW",
        "snippet": "                    app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect. Not exist user.', token)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:366-366",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 366,
        "end_line": 366,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    rid = f_rid_get(request)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:12-12",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 12,
        "end_line": 12,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    date = db.Column(db.DateTime, default=datetime.utcnow)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:401-401",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 401,
        "end_line": 401,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            tasks = TS_Task.query.filter(and_(or_(TS_Task.private==False, and_(TS_Task.uid1==current_user.id, TS_Task.private==True)), TS_Task.title.contains(tsearch))).order_by(TS_Task.date.desc()).all()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:59-59",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 59,
        "end_line": 59,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    rid = f_rid_get(request)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:63-80",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 63,
        "end_line": 80,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-passrec-no-rate-limit",
        "rule_description": "",
        "message": "CWE-640: Password recovery route without apparent rate limiting. Implement rate limiting to prevent brute force attacks on recovery tokens.\n",
        "severity": "LOW",
        "snippet": "@app.route('/login', methods=['POST','GET'])\ndef login():\n    if request.method == \"POST\":\n        ulogin = request.form['login']\n        upassword = request.form['password']\n        user = TS_User.query.filter_by(login=ulogin).first()\n        if user and check_password_hash(user.password, upassword):\n            login_user(user)\n            resp = make_response(redirect(url_for('myprofile')))\n            resp.set_cookie('rid', str(user.rid))\n            app.logger.info('[AUTH] [LOGIN] [Succeess] User:<%s>, role: <%s>', current_user.login, current_user.rid)\n            return resp\n        else:\n            flash('Login or password incorrect')\n            app.logger.warning('[AUTH] [LOGIN] [Failed] User:<%s> Password:<%s>', ulogin, upassword)\n            return redirect(url_for('login'))\n    else:\n        return render_template(\"login.html\")"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:145-145",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 145,
        "end_line": 145,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                token_data = jwt_decod(token)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:337-337",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 337,
        "end_line": 337,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    tasks = TS_Task.query.filter(TS_Task.uid2==current_user.id).order_by(TS_Task.date.desc()).all()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:186-186",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 186,
        "end_line": 186,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.logging-passwords",
        "rule_description": "",
        "message": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n",
        "severity": "LOW",
        "snippet": "                        app.logger.info('[AUTH] [passrec] [Succeess] For User:<%s> change password', user.login)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:309-309",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 309,
        "end_line": 309,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    pagination = Pagination(page=page, total=tasks.total, record_name='tasks')"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:437-437",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 437,
        "end_line": 437,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        user = TS_User.query.filter(TS_User.id==id).order_by(TS_User.date.desc()).first()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:497-497",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 497,
        "end_line": 497,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.logging-passwords",
        "rule_description": "",
        "message": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n",
        "severity": "LOW",
        "snippet": "            app.logger.warning('[AUTH] [admreg] [Failed] Please, enter other login or not null login or not null password')"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:307-308",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 307,
        "end_line": 308,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check",
        "rule_description": "",
        "message": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n",
        "severity": "LOW",
        "snippet": "    if rid == 0:\n        tasks = TS_Task.query.filter(TS_Task.uid1==current_user.id).order_by(TS_Task.tid.desc()).paginate(page=page, per_page=10)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:31-31",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 31,
        "end_line": 31,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            res = True"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:388-388",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 388,
        "end_line": 388,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    pagination = Pagination(page=page, total=users.total, record_name='users')"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:168-168",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 168,
        "end_line": 168,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            token = request.args.get('token')"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:16-16",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 16,
        "end_line": 16,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        rid = int(request.cookies.get('rid'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:201-202",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 201,
        "end_line": 202,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check-enhanced",
        "rule_description": "",
        "message": "CWE-269: Direct role comparison with magic values. Ensure response.status_code comes from authenticated server-side source, not from user-controlled data (cookies, headers, form data).\n",
        "severity": "LOW",
        "snippet": "    if response.status_code == 401:\n        return redirect('/login')"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:306-306",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 306,
        "end_line": 306,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        tasks = TS_Task.query.filter(or_(TS_Task.private==False, and_(TS_Task.uid1==current_user.id, TS_Task.private==True))).order_by(TS_Task.tid.desc()).paginate(page=page, per_page=10)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:347-347",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 347,
        "end_line": 347,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        task_access = f_task_acl(task, rid, current_user.id)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:5-5",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 5,
        "end_line": 5,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "db = SQLAlchemy()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:28-28",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 28,
        "end_line": 28,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            res = True"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:154-154",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 154,
        "end_line": 154,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                user = TS_User.query.filter(TS_User.id==uid).first()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:320-320",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 320,
        "end_line": 320,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        task_access = f_task_acl(task, rid, current_user.id)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:146-146",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 146,
        "end_line": 146,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.logging-sensitive-data-enhanced",
        "rule_description": "",
        "message": "Information disclosure (CWE-532): Logging potentially sensitive data. Avoid logging passwords, tokens, or personal information.\n",
        "severity": "LOW",
        "snippet": "                app.logger.info('[AUTH] [passrec] [Succeess] For token: <%s> exist data: <%s>', token, token_data)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:29-29",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 29,
        "end_line": 29,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "formatter = RequestFormatter('[%(asctime)s] [%(levelname)s] from %(remote_addr)s req: %(url)s > %(message)s')"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:23-23",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 23,
        "end_line": 23,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    res = False"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:418-418",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 418,
        "end_line": 418,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        pagination = Pagination(page=page, total=users.total, record_name='users')"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:413-413",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 413,
        "end_line": 413,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    reg = 0"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:113-113",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 113,
        "end_line": 113,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.logging-passwords",
        "rule_description": "",
        "message": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n",
        "severity": "LOW",
        "snippet": "            app.logger.warning('[AUTH] [REG] [Failed] Please, enter other login or not null login or not null password')"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:96-96",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 96,
        "end_line": 96,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        ulogin=request.form['login']"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:26-26",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 26,
        "end_line": 26,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            record.remote_addr = None"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:424-424",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 424,
        "end_line": 424,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            reg = 1"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:397-397",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 397,
        "end_line": 397,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        rid = f_rid_get(request)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:365-365",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 365,
        "end_line": 365,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    task = TS_Task.query.filter(TS_Task.tid==tid).order_by(TS_Task.date.desc()).first()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:24-24",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 24,
        "end_line": 24,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    uid1 = db.Column(db.Integer, db.ForeignKey('TS_User.id'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:157-157",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 157,
        "end_line": 157,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.logging-sensitive-data-enhanced",
        "rule_description": "",
        "message": "Information disclosure (CWE-532): Logging potentially sensitive data. Avoid logging passwords, tokens, or personal information.\n",
        "severity": "LOW",
        "snippet": "                    app.logger.info('[AUTH] [passrec] [Succeess] For token: <%s> exist user: <%s>', token, user.login)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:191-191",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 191,
        "end_line": 191,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                p = 0"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:414-414",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 414,
        "end_line": 414,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    rid = f_rid_get(request)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:165-165",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 165,
        "end_line": 165,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.logging-sensitive-data-enhanced",
        "rule_description": "",
        "message": "Information disclosure (CWE-532): Logging potentially sensitive data. Avoid logging passwords, tokens, or personal information.\n",
        "severity": "LOW",
        "snippet": "                app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect. Not exist data.', token)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:135-135",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 135,
        "end_line": 135,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.logging-sensitive-data-enhanced",
        "rule_description": "",
        "message": "Information disclosure (CWE-532): Logging potentially sensitive data. Avoid logging passwords, tokens, or personal information.\n",
        "severity": "LOW",
        "snippet": "                    app.logger.info('[AUTH] [passrec] [Succeess] For User:<%s> token <%s> created', ulogin, token)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:387-387",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 387,
        "end_line": 387,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    users = TS_User.query.order_by(TS_User.id.desc()).paginate(page=page, per_page=10)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:24-25",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 24,
        "end_line": 25,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check",
        "rule_description": "",
        "message": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n",
        "severity": "LOW",
        "snippet": "    if rid == 2:\n        res = True"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:170-170",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 170,
        "end_line": 170,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                token_data = jwt_decod(token)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:172-172",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 172,
        "end_line": 172,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                p = 0"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:97-97",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 97,
        "end_line": 97,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        upassword=request.form['password']"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:22-22",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 22,
        "end_line": 22,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            record.url = request.url"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:23-23",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 23,
        "end_line": 23,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    did = db.Column(db.Integer)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:457-457",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 457,
        "end_line": 457,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    rid = f_rid_get(request)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:416-429",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 416,
        "end_line": 429,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check-enhanced",
        "rule_description": "",
        "message": "CWE-269: Direct role comparison with magic values. Ensure rid comes from authenticated server-side source, not from user-controlled data (cookies, headers, form data).\n",
        "severity": "LOW",
        "snippet": "    if rid == 2:\n        users = TS_User.query.order_by(TS_User.id.desc()).paginate(page=page, per_page=10)\n        pagination = Pagination(page=page, total=users.total, record_name='users')\n        app.logger.info('[FUNC] [/adminpanel] [Succeess] User:<%s> Role:<%d>/<%d> Read users: <%d>', current_user.login, current_user.rid, rid, len(users.items))\n        return render_template(\"admpanel.html\", users=users, rteam=rteam, reg=reg, pagination=pagination)\n    else:\n        users = TS_User.query.filter(TS_User.rid==2).order_by(TS_User.id.desc()).all()\n        if len(users) == 0:\n            reg = 1\n            app.logger.info('[FUNC] [/adminpanel] [Succeess] User:<%s> Role:<%d>/<%d> Start initialization >> Registration of a new captain for the service', current_user.login, current_user.rid, rid)\n            return render_template(\"admpanel.html\", users=users, rteam=rteam, reg=reg)\n        else:\n            app.logger.warning('[FUNC] [/adminpanel] [Failed] User:<%s> Access is denied', current_user.login)\n            return redirect(url_for('index'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:417-417",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 417,
        "end_line": 417,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        users = TS_User.query.order_by(TS_User.id.desc()).paginate(page=page, per_page=10)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:395-395",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 395,
        "end_line": 395,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    tsearch = request.args.get('search')"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:238-238",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 238,
        "end_line": 238,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    task = TS_Task.query.filter(TS_Task.tid==tid).order_by(TS_Task.date.desc()).first()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:9-9",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 9,
        "end_line": 9,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    __tablename__ = 'TS_User'"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:31-31",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 31,
        "end_line": 31,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    TS_User = db.relationship(\"TS_User\", back_populates=\"TS_Task\")"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:368-368",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 368,
        "end_line": 368,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        task_access = f_task_acl(task, rid, current_user.id)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:29-31",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 29,
        "end_line": 31,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check",
        "rule_description": "",
        "message": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n",
        "severity": "LOW",
        "snippet": "    if rid == 0:\n        if task.uid1 == uid:\n            res = True"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:422-422",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 422,
        "end_line": 422,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        users = TS_User.query.filter(TS_User.rid==2).order_by(TS_User.id.desc()).all()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/config.py:3-3",
        "file_path": "/taskstate_10/tsapp/config.py",
        "start_line": 3,
        "end_line": 3,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "file_log = os.path.abspath(os.getcwd()) + \"/logs/TS_Events.log\""
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:177-177",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 177,
        "end_line": 177,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                uid = token_data[\"id\"]"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:151-151",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 151,
        "end_line": 151,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.logging-sensitive-data-enhanced",
        "rule_description": "",
        "message": "Information disclosure (CWE-532): Logging potentially sensitive data. Avoid logging passwords, tokens, or personal information.\n",
        "severity": "LOW",
        "snippet": "                app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect', token)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:156-156",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 156,
        "end_line": 156,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                    p = 1"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:284-284",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 284,
        "end_line": 284,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    task = TS_Task.query.filter(and_(TS_Task.uid1==current_user.id, TS_Task.tid==tid)).order_by(TS_Task.date.desc()).first()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:436-451",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 436,
        "end_line": 451,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check-enhanced",
        "rule_description": "",
        "message": "CWE-269: Direct role comparison with magic values. Ensure rid comes from authenticated server-side source, not from user-controlled data (cookies, headers, form data).\n",
        "severity": "LOW",
        "snippet": "    if rid == 2:\n        user = TS_User.query.filter(TS_User.id==id).order_by(TS_User.date.desc()).first()\n        if user:\n            if user.rid != 2:\n                user.rid += 1\n                try:\n                    db.session.commit()\n                    app.logger.info('[FUNC] [/adminpanel/nrteam] [Succeess] User:<%s> Role:<%d>/<%d> For user:<%s> upd role to:<%d>', current_user.login, current_user.rid, rid, user.login, user.rid)\n                except:\n                    app.logger.error('[FUNC] [/adminpanel/nrteam] [Succeess] User:<%s> Role:<%d> For user:<%s> upd role to:<%d>. Error DB delete!', current_user.login, current_user.rid, user.login, user.rid)\n                    return \"Error DB delete!\"\n        else:\n            app.logger.warning('[FUNC] [/adminpanel/nrteam] [Failed] User:<%s> Role:<%d> For user:<%s> upd role to:<%d> User not found!', current_user.login, current_user.rid, user.login, user.rid)\n        return redirect(url_for('adm'))\n    else:\n        redirect(url_for('index'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:34-34",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 34,
        "end_line": 34,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "manager = LoginManager(app)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:303-304",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 303,
        "end_line": 304,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check",
        "rule_description": "",
        "message": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n",
        "severity": "LOW",
        "snippet": "    if rid == 2:\n        tasks = TS_Task.query.order_by(TS_Task.tid.desc()).paginate(page=page, per_page=10)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:301-301",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 301,
        "end_line": 301,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    rid = f_rid_get(request)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:302-302",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 302,
        "end_line": 302,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    page = request.args.get(get_page_parameter(), type=int, default=1)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:304-304",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 304,
        "end_line": 304,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        tasks = TS_Task.query.order_by(TS_Task.tid.desc()).paginate(page=page, per_page=10)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/config.py:7-7",
        "file_path": "/taskstate_10/tsapp/config.py",
        "start_line": 7,
        "end_line": 7,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "SQLALCHEMY_DATABASE_URI = 'sqlite:///'+file_db"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:305-306",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 305,
        "end_line": 306,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check",
        "rule_description": "",
        "message": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n",
        "severity": "LOW",
        "snippet": "    if rid == 1:\n        tasks = TS_Task.query.filter(or_(TS_Task.private==False, and_(TS_Task.uid1==current_user.id, TS_Task.private==True))).order_by(TS_Task.tid.desc()).paginate(page=page, per_page=10)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:318-318",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 318,
        "end_line": 318,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    rid = f_rid_get(request)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:15-15",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 15,
        "end_line": 15,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    email = db.Column(db.String(255))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:30-31",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 30,
        "end_line": 31,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check",
        "rule_description": "",
        "message": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что task.uid1 не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n",
        "severity": "LOW",
        "snippet": "        if task.uid1 == uid:\n            res = True"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:14-14",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 14,
        "end_line": 14,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    password = db.Column(db.String(255), nullable=False)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:27-27",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 27,
        "end_line": 27,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    title = db.Column(db.String(255))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:252-278",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 252,
        "end_line": 278,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-passrec-no-rate-limit",
        "rule_description": "",
        "message": "CWE-640: Password recovery route without apparent rate limiting. Implement rate limiting to prevent brute force attacks on recovery tokens.\n",
        "severity": "LOW",
        "snippet": "@app.route('/task/<int:tid>/edit', methods=['POST','GET'])\n@login_required\ndef task_edit(tid):\n    task = TS_Task.query.filter(and_(TS_Task.uid1==current_user.id, TS_Task.tid==tid)).order_by(TS_Task.date.desc()).first()\n    if task:\n        if request.method == \"POST\":\n            if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):\n                task.title = request.form['title']\n                task.description = request.form['description']\n                task.did = int(request.form['did'])\n                task.private = eval(request.form['private'])\n                try:\n                    db.session.commit()\n                    app.logger.info('[FUNC] [/task/edit] [Succeess] User:<%s> Edit task: <%s> owner:<%s>', current_user.login, task.tid, task.TS_User.login)\n                    return redirect(url_for('mytask'))\n                except:\n                    app.logger.error('[FUNC] [/task/edit] [Failed] User:<%s> Edit task: <%s> owner:<%s>. Error DB insert/', current_user.login, task.tid, task.TS_User.login)\n                    flash('Error DB insert')\n                    return redirect('/task/' + str(tid) + '/edit')\n            else:\n                flash('Please, enter all rewuired data!')\n                return redirect('/task/' + str(tid) + '/edit')\n        else:\n            return render_template(\"task_edit.html\", task=task, desteam=desteam)\n    else:\n        app.logger.warning('[FUNC] [/task/edit] [Failed] User:<%s> Edit task: <%s> owner:<%s>', current_user.login, task.tid, task.TS_User.login)\n        return redirect(url_for('mytask'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:66-66",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 66,
        "end_line": 66,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        ulogin = request.form['login']"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:95-117",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 95,
        "end_line": 117,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check-enhanced",
        "rule_description": "",
        "message": "CWE-269: Direct role comparison with magic values. Ensure request.method comes from authenticated server-side source, not from user-controlled data (cookies, headers, form data).\n",
        "severity": "LOW",
        "snippet": "    if request.method == \"POST\":\n        ulogin=request.form['login']\n        upassword=request.form['password']\n        if not(ulogin or upassword):\n            flash('Please, fill fileds: login, password')\n            return redirect('/reg')\n        elif not(TS_User.query.filter_by(login=ulogin).first()) and ulogin and upassword:\n            user = TS_User(login=ulogin, password=generate_password_hash(upassword), email=request.form['email'], rid=0, token=\"\")\n            try:\n                db.session.add(user)\n                db.session.commit()\n                app.logger.info('[AUTH] [REG] [Succeess] User:<%s>', ulogin)\n                return redirect('/login')\n            except:\n                app.logger.error('[AUTH] [REG] [Failed] User:<%s>. Error DB insert.', ulogin)\n                flash('Error DB insert')\n                return redirect('/reg')\n        else:\n            app.logger.warning('[AUTH] [REG] [Failed] Please, enter other login or not null login or not null password')\n            flash('Please, enter other login or not null login or not null password')\n            return redirect('/reg')\n    else:\n        return render_template(\"reg.html\")"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/sconfig.py:7-7",
        "file_path": "/taskstate_10/tsapp/sconfig.py",
        "start_line": 7,
        "end_line": 7,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "rteam = [\"Sailor\", \"Corsair\", \"Captain\"]"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:42-42",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 42,
        "end_line": 42,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    jwt_data = jwt.decode(token, JWT_KEY, algorithms=\"HS256\")"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:68-68",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 68,
        "end_line": 68,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        user = TS_User.query.filter_by(login=ulogin).first()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:405-405",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 405,
        "end_line": 405,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-ssti-render-template-string-taint",
        "rule_description": "",
        "message": "Возможная SSTI (CWE-1336): пользовательский ввод попадает в render_template_string(). Проверьте, что строка не формируется из request.args/request.form/request.values/JSON.\n",
        "severity": "LOW",
        "snippet": "        return render_template(\"searchlist.html\", tasks=tasks, tstatus=tstatus, tsearch=render_template_string(tsearch))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:181-181",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 181,
        "end_line": 181,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                    user.password = generate_password_hash(request.args.get('password'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:153-153",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 153,
        "end_line": 153,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                uid = token_data[\"id\"]"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:77-77",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 77,
        "end_line": 77,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.logging-passwords",
        "rule_description": "",
        "message": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n",
        "severity": "LOW",
        "snippet": "            app.logger.warning('[AUTH] [LOGIN] [Failed] User:<%s> Password:<%s>', ulogin, upassword)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:93-117",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 93,
        "end_line": 117,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-passrec-no-rate-limit",
        "rule_description": "",
        "message": "CWE-640: Password recovery route without apparent rate limiting. Implement rate limiting to prevent brute force attacks on recovery tokens.\n",
        "severity": "LOW",
        "snippet": "@app.route('/reg', methods=['POST','GET'])\ndef reg():\n    if request.method == \"POST\":\n        ulogin=request.form['login']\n        upassword=request.form['password']\n        if not(ulogin or upassword):\n            flash('Please, fill fileds: login, password')\n            return redirect('/reg')\n        elif not(TS_User.query.filter_by(login=ulogin).first()) and ulogin and upassword:\n            user = TS_User(login=ulogin, password=generate_password_hash(upassword), email=request.form['email'], rid=0, token=\"\")\n            try:\n                db.session.add(user)\n                db.session.commit()\n                app.logger.info('[AUTH] [REG] [Succeess] User:<%s>', ulogin)\n                return redirect('/login')\n            except:\n                app.logger.error('[AUTH] [REG] [Failed] User:<%s>. Error DB insert.', ulogin)\n                flash('Error DB insert')\n                return redirect('/reg')\n        else:\n            app.logger.warning('[AUTH] [REG] [Failed] Please, enter other login or not null login or not null password')\n            flash('Please, enter other login or not null login or not null password')\n            return redirect('/reg')\n    else:\n        return render_template(\"reg.html\")"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:148-148",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 148,
        "end_line": 148,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                p = 0"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:241-241",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 241,
        "end_line": 241,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        task_access = f_task_acl(task, rid, current_user.id)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:209-209",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 209,
        "end_line": 209,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    tasks = TS_Task.query.filter(TS_Task.uid1==current_user.id).order_by(TS_Task.date.desc()).all()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:25-25",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 25,
        "end_line": 25,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            record.url = None"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:10-10",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 10,
        "end_line": 10,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    id = db.Column(db.Integer, primary_key=True)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:36-36",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 36,
        "end_line": 36,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    jwt_data = {\"id\": user.id,\"login\": user.login}"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:259-259",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 259,
        "end_line": 259,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                task.title = request.form['title']"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:213-232",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 213,
        "end_line": 232,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-passrec-no-rate-limit",
        "rule_description": "",
        "message": "CWE-640: Password recovery route without apparent rate limiting. Implement rate limiting to prevent brute force attacks on recovery tokens.\n",
        "severity": "LOW",
        "snippet": "@app.route('/taskcreate', methods=['POST'])\n@login_required\ndef taskcreate():\n    if request.method == \"POST\":\n        if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):\n            task = TS_Task(did=int(request.form['did']), title=request.form['title'], description=request.form['description'], private=eval(request.form['private']), uid1=current_user.id, uid2=-1)\n            try:\n                db.session.add(task)\n                db.session.commit()\n                app.logger.info('[FUNC] [/taskcreate] [Succeess] User:<%s> Title:<%s> Description:<%s>',current_user.login, task.title, task.description)\n                return redirect(url_for('mytask'))\n            except:\n                app.logger.error('[FUNC] [/taskcreate] [Failed] User:<%s> Error DB insert',current_user.login)\n                flash('Error DB insert')\n                return redirect(url_for('mytask'))\n        else:\n            flash('Please, enter all rewuired data!')\n            return redirect(url_for('mytask'))\n    else:\n        return redirect(url_for('mytask'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:29-29",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 29,
        "end_line": 29,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    kstatus = db.Column(db.Integer, default=0)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:458-473",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 458,
        "end_line": 473,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check-enhanced",
        "rule_description": "",
        "message": "CWE-269: Direct role comparison with magic values. Ensure rid comes from authenticated server-side source, not from user-controlled data (cookies, headers, form data).\n",
        "severity": "LOW",
        "snippet": "    if rid == 2:\n        user = TS_User.query.filter(TS_User.id==id).order_by(TS_User.date.desc()).first()\n        if user:\n            if user.rid != 0:\n                user.rid -= 1\n                try:\n                    db.session.commit()\n                    app.logger.info('[FUNC] [/adminpanel/brteam] [Succeess] User:<%s> Role:<%d>/<%d> For user:<%s> upd role to:<%d>', current_user.login, current_user.rid, rid, user.login, user.rid)\n                except:\n                    app.logger.error('[FUNC] [/adminpanel/brteam] [Succeess] User:<%s> Role:<%d> For user:<%s> upd role to:<%d>. Error DB delete!', current_user.login, current_user.rid, user.login, user.rid)\n                    return \"Error DB delete!\"\n        else:\n            app.logger.warning('[FUNC] [/adminpanel/brteam] [Failed] User:<%s> Role:<%d> For user:<%s> upd role to:<%d> User not found!', current_user.login, current_user.rid, user.login, user.rid)\n        return redirect(url_for('adm'))\n    else:\n        redirect(url_for('index'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/config.py:4-4",
        "file_path": "/taskstate_10/tsapp/config.py",
        "start_line": 4,
        "end_line": 4,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "file_db = os.path.abspath(os.getcwd())+\"/data/taskstate.db\""
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:30-30",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 30,
        "end_line": 30,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    private = db.Column(db.Boolean, default=False)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:122-122",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 122,
        "end_line": 122,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    p = 0"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/sconfig.py:6-6",
        "file_path": "/taskstate_10/tsapp/sconfig.py",
        "start_line": 6,
        "end_line": 6,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "tstatus = [\"ToDo\",\"Doing\", \"Done\"]"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:415-415",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 415,
        "end_line": 415,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    page = request.args.get(get_page_parameter(), type=int, default=1)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:11-11",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 11,
        "end_line": 11,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    rid = db.Column(db.Integer)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:480-480",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 480,
        "end_line": 480,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        ulogin=request.form['login']"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:423-429",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 423,
        "end_line": 429,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check-enhanced",
        "rule_description": "",
        "message": "CWE-269: Direct role comparison with magic values. Ensure len(users) comes from authenticated server-side source, not from user-controlled data (cookies, headers, form data).\n",
        "severity": "LOW",
        "snippet": "        if len(users) == 0:\n            reg = 1\n            app.logger.info('[FUNC] [/adminpanel] [Succeess] User:<%s> Role:<%d>/<%d> Start initialization >> Registration of a new captain for the service', current_user.login, current_user.rid, rid)\n            return render_template(\"admpanel.html\", users=users, rteam=rteam, reg=reg)\n        else:\n            app.logger.warning('[FUNC] [/adminpanel] [Failed] User:<%s> Access is denied', current_user.login)\n            return redirect(url_for('index'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:39-39",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 39,
        "end_line": 39,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "handler = RotatingFileHandler(file_log, maxBytes=1048576, backupCount=10)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:344-344",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 344,
        "end_line": 344,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    task = TS_Task.query.filter(TS_Task.tid==tid).order_by(TS_Task.date.desc()).first()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:32-32",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 32,
        "end_line": 32,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "app = create_app()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:257-275",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 257,
        "end_line": 275,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check-enhanced",
        "rule_description": "",
        "message": "CWE-269: Direct role comparison with magic values. Ensure request.method comes from authenticated server-side source, not from user-controlled data (cookies, headers, form data).\n",
        "severity": "LOW",
        "snippet": "        if request.method == \"POST\":\n            if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):\n                task.title = request.form['title']\n                task.description = request.form['description']\n                task.did = int(request.form['did'])\n                task.private = eval(request.form['private'])\n                try:\n                    db.session.commit()\n                    app.logger.info('[FUNC] [/task/edit] [Succeess] User:<%s> Edit task: <%s> owner:<%s>', current_user.login, task.tid, task.TS_User.login)\n                    return redirect(url_for('mytask'))\n                except:\n                    app.logger.error('[FUNC] [/task/edit] [Failed] User:<%s> Edit task: <%s> owner:<%s>. Error DB insert/', current_user.login, task.tid, task.TS_User.login)\n                    flash('Error DB insert')\n                    return redirect('/task/' + str(tid) + '/edit')\n            else:\n                flash('Please, enter all rewuired data!')\n                return redirect('/task/' + str(tid) + '/edit')\n        else:\n            return render_template(\"task_edit.html\", task=task, desteam=desteam)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:398-399",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 398,
        "end_line": 399,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check",
        "rule_description": "",
        "message": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n",
        "severity": "LOW",
        "snippet": "        if rid == 2:\n            tasks = TS_Task.query.filter(TS_Task.title.contains(tsearch)).order_by(TS_Task.date.desc()).all()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/sconfig.py:4-4",
        "file_path": "/taskstate_10/tsapp/sconfig.py",
        "start_line": 4,
        "end_line": 4,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "JWT_KEY = 'CTF-2#PirateLabel'"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:400-401",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 400,
        "end_line": 401,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check",
        "rule_description": "",
        "message": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n",
        "severity": "LOW",
        "snippet": "        if rid == 1:\n            tasks = TS_Task.query.filter(and_(or_(TS_Task.private==False, and_(TS_Task.uid1==current_user.id, TS_Task.private==True)), TS_Task.title.contains(tsearch))).order_by(TS_Task.date.desc()).all()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/config.py:5-5",
        "file_path": "/taskstate_10/tsapp/config.py",
        "start_line": 5,
        "end_line": 5,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "FLASK_APP = 'TS_app'"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:345-345",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 345,
        "end_line": 345,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    rid = f_rid_get(request)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:17-17",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 17,
        "end_line": 17,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    TS_Task = db.relationship(\"TS_Task\", back_populates=\"TS_User\")"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:9-9",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 9,
        "end_line": 9,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    app.secret_key = SECRET_KEY"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:23-23",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 23,
        "end_line": 23,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            record.remote_addr = request.remote_addr"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:481-481",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 481,
        "end_line": 481,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        upassword=request.form['password']"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:120-196",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 120,
        "end_line": 196,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-passrec-no-rate-limit",
        "rule_description": "",
        "message": "CWE-640: Password recovery route without apparent rate limiting. Implement rate limiting to prevent brute force attacks on recovery tokens.\n",
        "severity": "LOW",
        "snippet": "@app.route('/passrec', methods=['POST','GET'])\ndef passrec():\n    p = 0\n    token = \"\"\n    if len(request.args) > 0:\n        if request.args.get('login'):\n            ulogin = request.args.get('login')\n            user = TS_User.query.filter(TS_User.login==ulogin).first()\n            if user:\n                token = jwt_encod(user)\n                user.token = token\n                try:\n                    db.session.add(user)\n                    db.session.commit()\n                    flash('Token created...')\n                    app.logger.info('[AUTH] [passrec] [Succeess] For User:<%s> token <%s> created', ulogin, token)\n                except:\n                    app.logger.error('[AUTH] [passrec] [Failed] User:<%s>. Error DB insert.', ulogin)\n                    flash('Error DB insert')\n            else:\n                flash('Login incorrect')\n                app.logger.warning('[AUTH] [passrec] [Failed] User:<%s> does not exist', ulogin)\n        if request.args.get('token') and not request.args.get('password'):\n            token = request.args.get('token')\n            try:\n                token_data = jwt_decod(token)\n                app.logger.info('[AUTH] [passrec] [Succeess] For token: <%s> exist data: <%s>', token, token_data)\n            except:\n                p = 0\n                token_data = \"\"\n                flash('Token incorrect')\n                app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect', token)\n            if token_data:\n                uid = token_data[\"id\"]\n                user = TS_User.query.filter(TS_User.id==uid).first()\n                if user:\n                    p = 1\n                    app.logger.info('[AUTH] [passrec] [Succeess] For token: <%s> exist user: <%s>', token, user.login)\n                    return render_template(\"recpass.html\", p=p, token=token)\n                else:\n                    p = 0\n                    flash('Token incorrect')\n                    app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect. Not exist user.', token)\n            else:\n                p = 0\n                app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect. Not exist data.', token)\n                flash('Token incorrect')\n        if request.args.get('token') and request.args.get('password'):\n            token = request.args.get('token')\n            try:\n                token_data = jwt_decod(token)\n            except:\n                p = 0\n                token_data = \"\"\n                app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect. Not exist data. Password: <%s>', token, request.args.get('password'))\n                flash('Token incorrect')\n            if token_data:\n                uid = token_data[\"id\"]\n                user = TS_User.query.filter(TS_User.id==uid).first()\n                if user:\n                    p = 0\n                    user.password = generate_password_hash(request.args.get('password'))\n                    user.token = \"\"\n                    try:\n                        db.session.add(user)\n                        db.session.commit()\n                        app.logger.info('[AUTH] [passrec] [Succeess] For User:<%s> change password', user.login)\n                    except:\n                        app.logger.error('[AUTH] [passrec] [Failed] User:<%s>. Error DB insert.', user.login)\n                        flash('Error DB insert')\n            else:\n                p = 0\n                flash('Token incorrect')\n                app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect. Not exist data.', token)\n    else:\n        pass\n    return render_template(\"recpass.html\", p=p, token=token)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:322-322",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 322,
        "end_line": 322,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            task.uid2 = current_user.id"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:130-130",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 130,
        "end_line": 130,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                user.token = token"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:402-403",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 402,
        "end_line": 403,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check",
        "rule_description": "",
        "message": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n",
        "severity": "LOW",
        "snippet": "        if rid == 0:\n            tasks = TS_Task.query.filter(and_(TS_Task.uid1==current_user.id, TS_Task.title.contains(tsearch))).order_by(TS_Task.date.desc()).all()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:126-126",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 126,
        "end_line": 126,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            ulogin = request.args.get('login')"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:65-80",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 65,
        "end_line": 80,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check-enhanced",
        "rule_description": "",
        "message": "CWE-269: Direct role comparison with magic values. Ensure request.method comes from authenticated server-side source, not from user-controlled data (cookies, headers, form data).\n",
        "severity": "LOW",
        "snippet": "    if request.method == \"POST\":\n        ulogin = request.form['login']\n        upassword = request.form['password']\n        user = TS_User.query.filter_by(login=ulogin).first()\n        if user and check_password_hash(user.password, upassword):\n            login_user(user)\n            resp = make_response(redirect(url_for('myprofile')))\n            resp.set_cookie('rid', str(user.rid))\n            app.logger.info('[AUTH] [LOGIN] [Succeess] User:<%s>, role: <%s>', current_user.login, current_user.rid)\n            return resp\n        else:\n            flash('Login or password incorrect')\n            app.logger.warning('[AUTH] [LOGIN] [Failed] User:<%s> Password:<%s>', ulogin, upassword)\n            return redirect(url_for('login'))\n    else:\n        return render_template(\"login.html\")"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:178-178",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 178,
        "end_line": 178,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                user = TS_User.query.filter(TS_User.id==uid).first()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:88-88",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 88,
        "end_line": 88,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    resp = make_response(redirect(url_for('index')))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:239-239",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 239,
        "end_line": 239,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    rid = f_rid_get(request)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/config.py:6-6",
        "file_path": "/taskstate_10/tsapp/config.py",
        "start_line": 6,
        "end_line": 6,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "FLASK_ENV = 'CTFdev'"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:25-25",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 25,
        "end_line": 25,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    uid2 = db.Column(db.Integer)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:386-386",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 386,
        "end_line": 386,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    page = request.args.get(get_page_parameter(), type=int, default=1)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:13-13",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 13,
        "end_line": 13,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    login = db.Column(db.String(128), nullable=False, unique=True)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:160-160",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 160,
        "end_line": 160,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                    p = 0"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:260-260",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 260,
        "end_line": 260,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                task.description = request.form['description']"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:317-317",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 317,
        "end_line": 317,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    task = TS_Task.query.filter(TS_Task.tid==tid).order_by(TS_Task.date.desc()).first()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:255-255",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 255,
        "end_line": 255,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    task = TS_Task.query.filter(and_(TS_Task.uid1==current_user.id, TS_Task.tid==tid)).order_by(TS_Task.date.desc()).first()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:83-90",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 83,
        "end_line": 90,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-passrec-no-rate-limit",
        "rule_description": "",
        "message": "CWE-640: Password recovery route without apparent rate limiting. Implement rate limiting to prevent brute force attacks on recovery tokens.\n",
        "severity": "LOW",
        "snippet": "@app.route('/logout', methods=['POST','GET'])\n@login_required\ndef logout():\n    app.logger.info('[AUTH] [LOGOUT] [Succeess] User:<%s>', current_user.login)\n    logout_user()\n    resp = make_response(redirect(url_for('index')))\n    resp.set_cookie('rid', \"\", 0)\n    return resp"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/config.py:8-8",
        "file_path": "/taskstate_10/tsapp/config.py",
        "start_line": 8,
        "end_line": 8,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "SQLALCHEMY_TRACK_MODIFICATIONS = False"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:37-37",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 37,
        "end_line": 37,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    app.logger.handlers = gunicorn_logger.handlers"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:22-22",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 22,
        "end_line": 22,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    tid = db.Column(db.Integer, primary_key=True)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:180-180",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 180,
        "end_line": 180,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                    p = 0"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:21-21",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 21,
        "end_line": 21,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    __tablename__ = 'TS_Task'"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:476-501",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 476,
        "end_line": 501,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-passrec-no-rate-limit",
        "rule_description": "",
        "message": "CWE-640: Password recovery route without apparent rate limiting. Implement rate limiting to prevent brute force attacks on recovery tokens.\n",
        "severity": "LOW",
        "snippet": "@app.route('/admreg', methods=['POST'])\n@login_required\ndef admreg():\n    if request.method == \"POST\":\n        ulogin=request.form['login']\n        upassword=request.form['password']\n        if not(ulogin or upassword):\n            flash('Please, fill fileds: login, password')\n            return redirect(url_for('adm'))\n        elif not(TS_User.query.filter_by(login=ulogin).first()) and ulogin and upassword:\n            user = TS_User(login=ulogin, password=generate_password_hash(upassword), email=request.form['email'], rid=2, token=\"\")\n            try:\n                db.session.add(user)\n                db.session.commit()\n                app.logger.info('[AUTH] [admreg] [Succeess] User:<%s> Role:<%d> registartion captain:<%s>',current_user.login, current_user.rid, ulogin)\n                return redirect(url_for('adm'))\n            except:\n                app.logger.error('[AUTH] [admreg] [Failed] User:<%s>. Error DB insert.', ulogin)\n                flash('Error DB insert')\n                return redirect(url_for('adm'))\n        else:\n            app.logger.warning('[AUTH] [admreg] [Failed] Please, enter other login or not null login or not null password')\n            flash('Please, enter other login or not null login or not null password')\n            return redirect(url_for('adm'))\n    else:\n        redirect(url_for('index'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:14-14",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 14,
        "end_line": 14,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    rid = 0"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:216-232",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 216,
        "end_line": 232,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check-enhanced",
        "rule_description": "",
        "message": "CWE-269: Direct role comparison with magic values. Ensure request.method comes from authenticated server-side source, not from user-controlled data (cookies, headers, form data).\n",
        "severity": "LOW",
        "snippet": "    if request.method == \"POST\":\n        if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):\n            task = TS_Task(did=int(request.form['did']), title=request.form['title'], description=request.form['description'], private=eval(request.form['private']), uid1=current_user.id, uid2=-1)\n            try:\n                db.session.add(task)\n                db.session.commit()\n                app.logger.info('[FUNC] [/taskcreate] [Succeess] User:<%s> Title:<%s> Description:<%s>',current_user.login, task.title, task.description)\n                return redirect(url_for('mytask'))\n            except:\n                app.logger.error('[FUNC] [/taskcreate] [Failed] User:<%s> Error DB insert',current_user.login)\n                flash('Error DB insert')\n                return redirect(url_for('mytask'))\n        else:\n            flash('Please, enter all rewuired data!')\n            return redirect(url_for('mytask'))\n    else:\n        return redirect(url_for('mytask'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/app.py:7-7",
        "file_path": "/taskstate_10/app.py",
        "start_line": 7,
        "end_line": 7,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "db_is_created = os.path.exists(file_db)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:67-67",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 67,
        "end_line": 67,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        upassword = request.form['password']"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:174-174",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 174,
        "end_line": 174,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.logging-passwords",
        "rule_description": "",
        "message": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n",
        "severity": "LOW",
        "snippet": "                app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect. Not exist data. Password: <%s>', token, request.args.get('password'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:410-429",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 410,
        "end_line": 429,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-admin-route-weak-authz",
        "rule_description": "",
        "message": "CWE-269: Admin route with potentially weak authorization. Verify that authorization checks are sufficient and cannot be bypassed.\n",
        "severity": "LOW",
        "snippet": "@app.route('/adm')\n@login_required\ndef adm():\n    reg = 0\n    rid = f_rid_get(request)\n    page = request.args.get(get_page_parameter(), type=int, default=1)\n    if rid == 2:\n        users = TS_User.query.order_by(TS_User.id.desc()).paginate(page=page, per_page=10)\n        pagination = Pagination(page=page, total=users.total, record_name='users')\n        app.logger.info('[FUNC] [/adminpanel] [Succeess] User:<%s> Role:<%d>/<%d> Read users: <%d>', current_user.login, current_user.rid, rid, len(users.items))\n        return render_template(\"admpanel.html\", users=users, rteam=rteam, reg=reg, pagination=pagination)\n    else:\n        users = TS_User.query.filter(TS_User.rid==2).order_by(TS_User.id.desc()).all()\n        if len(users) == 0:\n            reg = 1\n            app.logger.info('[FUNC] [/adminpanel] [Succeess] User:<%s> Role:<%d>/<%d> Start initialization >> Registration of a new captain for the service', current_user.login, current_user.rid, rid)\n            return render_template(\"admpanel.html\", users=users, rteam=rteam, reg=reg)\n        else:\n            app.logger.warning('[FUNC] [/adminpanel] [Failed] User:<%s> Access is denied', current_user.login)\n            return redirect(url_for('index'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:129-129",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 129,
        "end_line": 129,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                token = jwt_encod(user)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:399-399",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 399,
        "end_line": 399,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            tasks = TS_Task.query.filter(TS_Task.title.contains(tsearch)).order_by(TS_Task.date.desc()).all()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:71-71",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 71,
        "end_line": 71,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            resp = make_response(redirect(url_for('myprofile')))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:18-18",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 18,
        "end_line": 18,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            rid = 0"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:143-143",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 143,
        "end_line": 143,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            token = request.args.get('token')"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:459-459",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 459,
        "end_line": 459,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        user = TS_User.query.filter(TS_User.id==id).order_by(TS_User.date.desc()).first()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:36-36",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 36,
        "end_line": 36,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    gunicorn_logger = logging.getLogger('gunicorn.error')"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:435-435",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 435,
        "end_line": 435,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    rid = f_rid_get(request)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:479-501",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 479,
        "end_line": 501,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check-enhanced",
        "rule_description": "",
        "message": "CWE-269: Direct role comparison with magic values. Ensure request.method comes from authenticated server-side source, not from user-controlled data (cookies, headers, form data).\n",
        "severity": "LOW",
        "snippet": "    if request.method == \"POST\":\n        ulogin=request.form['login']\n        upassword=request.form['password']\n        if not(ulogin or upassword):\n            flash('Please, fill fileds: login, password')\n            return redirect(url_for('adm'))\n        elif not(TS_User.query.filter_by(login=ulogin).first()) and ulogin and upassword:\n            user = TS_User(login=ulogin, password=generate_password_hash(upassword), email=request.form['email'], rid=2, token=\"\")\n            try:\n                db.session.add(user)\n                db.session.commit()\n                app.logger.info('[AUTH] [admreg] [Succeess] User:<%s> Role:<%d> registartion captain:<%s>',current_user.login, current_user.rid, ulogin)\n                return redirect(url_for('adm'))\n            except:\n                app.logger.error('[AUTH] [admreg] [Failed] User:<%s>. Error DB insert.', ulogin)\n                flash('Error DB insert')\n                return redirect(url_for('adm'))\n        else:\n            app.logger.warning('[AUTH] [admreg] [Failed] Please, enter other login or not null login or not null password')\n            flash('Please, enter other login or not null login or not null password')\n            return redirect(url_for('adm'))\n    else:\n        redirect(url_for('index'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/sconfig.py:5-5",
        "file_path": "/taskstate_10/tsapp/sconfig.py",
        "start_line": 5,
        "end_line": 5,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "desteam = [\"External order\", \"Internal order\", \"Technical order\"]"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:26-26",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 26,
        "end_line": 26,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    date = db.Column(db.DateTime, default=datetime.utcnow)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:243-243",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 243,
        "end_line": 243,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            user2 = TS_User.query.filter(TS_User.id==task.uid2).order_by(TS_User.date.desc()).first()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:164-164",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 164,
        "end_line": 164,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                p = 0"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:261-261",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 261,
        "end_line": 261,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "                task.did = int(request.form['did'])"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:235-249",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 235,
        "end_line": 249,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-admin-route-weak-authz",
        "rule_description": "",
        "message": "CWE-269: Admin route with potentially weak authorization. Verify that authorization checks are sufficient and cannot be bypassed.\n",
        "severity": "LOW",
        "snippet": "@app.route('/task/<int:tid>')\n@login_required\ndef task_detail(tid):\n    task = TS_Task.query.filter(TS_Task.tid==tid).order_by(TS_Task.date.desc()).first()\n    rid = f_rid_get(request)\n    if task:\n        task_access = f_task_acl(task, rid, current_user.id)\n        if task_access:\n            user2 = TS_User.query.filter(TS_User.id==task.uid2).order_by(TS_User.date.desc()).first()\n            app.logger.info('[FUNC] [/task] [Succeess] User:<%s> Role:<%d> Read task: <%s> owner:<%s>', current_user.login, rid, task.tid, task.TS_User.login)\n            return render_template(\"task_detail.html\", task=task, tstatus=tstatus, desteam=desteam, user2=user2)\n        else:\n            return redirect(url_for('tasklist'))\n    else:\n        return redirect(url_for('tasklist'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:308-308",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 308,
        "end_line": 308,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        tasks = TS_Task.query.filter(TS_Task.uid1==current_user.id).order_by(TS_Task.tid.desc()).paginate(page=page, per_page=10)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:25-25",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 25,
        "end_line": 25,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "        res = True"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:37-37",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 37,
        "end_line": 37,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.jwt-encode-without-exp-claim-enhanced",
        "rule_description": "",
        "message": "CWE-640: JWT token without expiration. Add 'exp' field and verify token expiration. Tokens should be single-use and short-lived for password recovery.\n",
        "severity": "LOW",
        "snippet": "    token = jwt.encode(jwt_data, JWT_KEY, algorithm=\"HS256\")"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:16-16",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 16,
        "end_line": 16,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    token = db.Column(db.String(255))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/app.py:14-17",
        "file_path": "/taskstate_10/app.py",
        "start_line": 14,
        "end_line": 17,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check",
        "rule_description": "",
        "message": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что __name__ не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n",
        "severity": "LOW",
        "snippet": "if __name__ == '__main__':\n    with app.app_context():\n        db.create_all()\n        app.run()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:403-403",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 403,
        "end_line": 403,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            tasks = TS_Task.query.filter(and_(TS_Task.uid1==current_user.id, TS_Task.title.contains(tsearch))).order_by(TS_Task.date.desc()).all()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:26-28",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 26,
        "end_line": 28,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-privilege-magic-role-check",
        "rule_description": "",
        "message": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n",
        "severity": "LOW",
        "snippet": "    if rid == 1:\n        if task.private == False or (task.uid1 == uid and task.private == True):\n            res = True"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/func.py:7-7",
        "file_path": "/taskstate_10/tsapp/func.py",
        "start_line": 7,
        "end_line": 7,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    app = Flask(__name__)"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:392-407",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 392,
        "end_line": 407,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.flask-passrec-no-rate-limit",
        "rule_description": "",
        "message": "CWE-640: Password recovery route without apparent rate limiting. Implement rate limiting to prevent brute force attacks on recovery tokens.\n",
        "severity": "LOW",
        "snippet": "@app.route('/search', methods=['GET'])\n@login_required\ndef search():\n    tsearch = request.args.get('search')\n    if tsearch:\n        rid = f_rid_get(request)\n        if rid == 2:\n            tasks = TS_Task.query.filter(TS_Task.title.contains(tsearch)).order_by(TS_Task.date.desc()).all()\n        if rid == 1:\n            tasks = TS_Task.query.filter(and_(or_(TS_Task.private==False, and_(TS_Task.uid1==current_user.id, TS_Task.private==True)), TS_Task.title.contains(tsearch))).order_by(TS_Task.date.desc()).all()\n        if rid == 0:\n            tasks = TS_Task.query.filter(and_(TS_Task.uid1==current_user.id, TS_Task.title.contains(tsearch))).order_by(TS_Task.date.desc()).all()\n        app.logger.info('[FUNC] [/search] [Succeess] User:<%s> Role:<%d> Data:<%s>',current_user.login, rid, tsearch)\n        return render_template(\"searchlist.html\", tasks=tasks, tstatus=tstatus, tsearch=render_template_string(tsearch))\n    else:\n        return redirect(url_for('index'))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:127-127",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 127,
        "end_line": 127,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "            user = TS_User.query.filter(TS_User.login==ulogin).first()"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/models.py:28-28",
        "file_path": "/taskstate_10/tsapp/models.py",
        "start_line": 28,
        "end_line": 28,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.hardcoded-api-secrets",
        "rule_description": "",
        "message": "CWE-798: Hard-coded API key or token detected. Store in environment variables or secret manager.\n",
        "severity": "LOW",
        "snippet": "    description = db.Column(db.String(255))"
      },
      {
        "category": "semgrep",
        "location_key": "/taskstate_10/tsapp/routes.py:193-193",
        "file_path": "/taskstate_10/tsapp/routes.py",
        "start_line": 193,
        "end_line": 193,
        "rule_id": "Users.izelikson.python.CryptoSlon.SAST.rules.logging-sensitive-data-enhanced",
        "rule_description": "",
        "message": "Information disclosure (CWE-532): Logging potentially sensitive data. Avoid logging passwords, tokens, or personal information.\n",
        "severity": "LOW",
        "snippet": "                app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect. Not exist data.', token)"
      }
    ],
    "bandit": []
  }
}