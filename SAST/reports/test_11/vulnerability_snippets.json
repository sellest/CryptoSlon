{
  "metadata": {
    "source_report": "/Users/izelikson/python/CryptoSlon/SAST/reports/test_11/triage_analysis.json",
    "code_base_path": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_10",
    "generated_at": "2025-08-24T00:00:00Z",
    "total_snippets": 5
  },
  "vulnerabilities": [
    {
      "vulnerability": "Code Injection Vulnerability",
      "file": "/taskstate_10/tsapp/routes.py",
      "location": {
        "start_line": 217,
        "end_line": 217,
        "vulnerable_lines_only": " 217 >>>         if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):"
      },
      "context": {
        "before": " 207     @login_required\n 208     def mytask():\n 209         tasks = TS_Task.query.filter(TS_Task.uid1==current_user.id).order_by(TS_Task.date.desc()).all()\n 210         return render_template('task_mylist.html', tasks=tasks, desteam=desteam, tstatus=tstatus)\n 211     \n 212     \n 213     @app.route('/taskcreate', methods=['POST'])\n 214     @login_required\n 215     def taskcreate():\n 216         if request.method == \"POST\":",
        "after": " 218                 task = TS_Task(did=int(request.form['did']), title=request.form['title'], description=request.form['description'], private=eval(request.form['private']), uid1=current_user.id, uid2=-1)\n 219                 try:\n 220                     db.session.add(task)\n 221                     db.session.commit()\n 222                     app.logger.info('[FUNC] [/taskcreate] [Succeess] User:<%s> Title:<%s> Description:<%s>',current_user.login, task.title, task.description)\n 223                     return redirect(url_for('mytask'))\n 224                 except:\n 225                     app.logger.error('[FUNC] [/taskcreate] [Failed] User:<%s> Error DB insert',current_user.login)\n 226                     flash('Error DB insert')\n 227                     return redirect(url_for('mytask'))"
      },
      "risk": "HIGH",
      "severity": "HIGH",
      "cwe": "CWE-95 Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
      "sources": [
        "bandit"
      ]
    },
    {
      "vulnerability": "Hard-coded Credentials",
      "file": "/taskstate_10/tsapp/routes.py",
      "location": {
        "start_line": 102,
        "end_line": 102,
        "vulnerable_lines_only": " 102 >>>             user = TS_User(login=ulogin, password=generate_password_hash(upassword), email=request.form['email'], rid=0, token=\"\")"
      },
      "context": {
        "before": "  92     \n  93     @app.route('/reg', methods=['POST','GET'])\n  94     def reg():\n  95         if request.method == \"POST\":\n  96             ulogin=request.form['login']\n  97             upassword=request.form['password']\n  98             if not(ulogin or upassword):\n  99                 flash('Please, fill fileds: login, password')\n 100                 return redirect('/reg')\n 101             elif not(TS_User.query.filter_by(login=ulogin).first()) and ulogin and upassword:",
        "after": " 103                 try:\n 104                     db.session.add(user)\n 105                     db.session.commit()\n 106                     app.logger.info('[AUTH] [REG] [Succeess] User:<%s>', ulogin)\n 107                     return redirect('/login')\n 108                 except:\n 109                     app.logger.error('[AUTH] [REG] [Failed] User:<%s>. Error DB insert.', ulogin)\n 110                     flash('Error DB insert')\n 111                     return redirect('/reg')\n 112             else:"
      },
      "risk": "MEDIUM",
      "severity": "MEDIUM",
      "cwe": "CWE-259 Use of Hard-coded Password",
      "sources": [
        "bandit"
      ]
    },
    {
      "vulnerability": "Privilege Management Issues",
      "file": "/taskstate_10/app.py",
      "location": {
        "start_line": 14,
        "end_line": 17,
        "vulnerable_lines_only": "  14 >>> if __name__ == '__main__':\n  15 >>>     with app.app_context():\n  16 >>>         db.create_all()\n  17 >>>         app.run()"
      },
      "context": {
        "before": "   4     import time\n   5     import os\n   6     \n   7     db_is_created = os.path.exists(file_db)\n   8     if not db_is_created:\n   9         with app.app_context():\n  10             db.create_all()\n  11             app.logger.info('[INIT] [DB] [Succeess] DB create <%s>', app.config['SQLALCHEMY_DATABASE_URI'])\n  12             time.sleep(3)\n  13     ",
        "after": ""
      },
      "risk": "LOW",
      "severity": "LOW",
      "cwe": "CWE-269 Hardcoded Role Checks",
      "sources": [
        "semgrep"
      ]
    },
    {
      "vulnerability": "Weak Password Recovery Mechanism",
      "file": "/taskstate_10/tsapp/func.py",
      "location": {
        "start_line": 37,
        "end_line": 37,
        "vulnerable_lines_only": "  37 >>>     token = jwt.encode(jwt_data, JWT_KEY, algorithm=\"HS256\")"
      },
      "context": {
        "before": "  27             if task.private == False or (task.uid1 == uid and task.private == True):\n  28                 res = True\n  29         if rid == 0:\n  30             if task.uid1 == uid:\n  31                 res = True\n  32         return res\n  33     \n  34     \n  35     def jwt_encod(user):\n  36         jwt_data = {\"id\": user.id,\"login\": user.login}",
        "after": "  38         return token\n  39     \n  40     \n  41     def jwt_decod(token):\n  42         jwt_data = jwt.decode(token, JWT_KEY, algorithms=\"HS256\")\n  43         return jwt_data"
      },
      "risk": "LOW",
      "severity": "LOW",
      "cwe": "CWE-640 Lack of Expiration for Security Token",
      "sources": [
        "semgrep"
      ]
    },
    {
      "vulnerability": "Sensitive Data Logging",
      "file": "/taskstate_10/tsapp/routes.py",
      "location": {
        "start_line": 135,
        "end_line": 135,
        "vulnerable_lines_only": " 135 >>>                     app.logger.info('[AUTH] [passrec] [Succeess] For User:<%s> token <%s> created', ulogin, token)"
      },
      "context": {
        "before": " 125             if request.args.get('login'):\n 126                 ulogin = request.args.get('login')\n 127                 user = TS_User.query.filter(TS_User.login==ulogin).first()\n 128                 if user:\n 129                     token = jwt_encod(user)\n 130                     user.token = token\n 131                     try:\n 132                         db.session.add(user)\n 133                         db.session.commit()\n 134                         flash('Token created...')",
        "after": " 136                     except:\n 137                         app.logger.error('[AUTH] [passrec] [Failed] User:<%s>. Error DB insert.', ulogin)\n 138                         flash('Error DB insert')\n 139                 else:\n 140                     flash('Login incorrect')\n 141                     app.logger.warning('[AUTH] [passrec] [Failed] User:<%s> does not exist', ulogin)\n 142             if request.args.get('token') and not request.args.get('password'):\n 143                 token = request.args.get('token')\n 144                 try:\n 145                     token_data = jwt_decod(token)"
      },
      "risk": "LOW",
      "severity": "LOW",
      "cwe": "CWE-532 Information Disclosure Through Logs",
      "sources": [
        "semgrep"
      ]
    }
  ]
}