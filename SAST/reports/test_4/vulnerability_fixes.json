{
  "metadata": {
    "source_report": "/Users/izelikson/python/CryptoSlon/SAST/reports/test_4/vulnerability_snippets.json",
    "model": "gpt-5-mini",
    "template": "vulnerability_fix_v3",
    "generated_at": "2025-08-24T00:00:00Z",
    "total_fixes": 3
  },
  "fixes": [
    {
      "vulnerability_info": {
        "type": "Небезопасная динамическая оценка кода (eval/exec)",
        "cwe": "CWE-95 Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
        "file": "/taskstate_2/tsapp/routes.py",
        "location": "217-217",
        "severity": "HIGH"
      },
      "original_code": " 212     \n 213     @app.route('/taskcreate', methods=['POST'])\n 214     @login_required\n 215     def taskcreate():\n 216         if request.method == \"POST\":\n 217 >>>         if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):\n 218                 task = TS_Task(did=int(request.form['did']), title=request.form['title'], description=request.form['description'], private=eval(request.form['private']), uid1=current_user.id, uid2=-1)\n 219                 try:\n 220                     db.session.add(task)\n 221                     db.session.commit()\n 222                     app.logger.info('[FUNC] [/taskcreate] [Succeess] User:<%s> Title:<%s> Description:<%s>',current_user.login, task.title, task.description)",
      "suggested_fix": "Уберите eval/exec. Реализуйте явный маппинг допустимых операций или используйте безопасный парсер (например, ast.literal_eval) и строгую валидацию.",
      "llm_response": "# LLM FIX START\n    @app.route('/taskcreate', methods=['POST'])\n    @login_required\n    def taskcreate():\n        if request.method == \"POST\":\n            private_raw = request.form.get('private', '')\n            pl = private_raw.strip().lower()\n            if pl in ('true', '1', 'yes', 'y'):\n                private_val = True\n            elif pl in ('false', '0', 'no', 'n'):\n                private_val = False\n            else:\n                private_val = None\n            if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and private_val is not None):\n                task = TS_Task(did=int(request.form['did']), title=request.form['title'], description=request.form['description'], private=private_val, uid1=current_user.id, uid2=-1)\n                try:\n                    db.session.add(task)\n                    db.session.commit()\n                    app.logger.info('[FUNC] [/taskcreate] [Succeess] User:<%s> Title:<%s> Description:<%s>',current_user.login, task.title, task.description)\n# LLM FIX END",
      "model_used": "gpt-5-mini"
    },
    {
      "vulnerability_info": {
        "type": "Хардкоденные секреты и пароли в коде",
        "cwe": "CWE-798 Use of Hard-coded Credentials",
        "file": "/taskstate_2/tsapp/sconfig.py",
        "location": "3-3",
        "severity": "MEDIUM"
      },
      "original_code": "   1     import os\n   2     \n   3 >>> SECRET_KEY = 'CTF-2#SecretKey'\n   4     JWT_KEY = 'CTF-2#PirateLabel'\n   5     desteam = [\"External order\", \"Internal order\", \"Technical order\"]\n   6     tstatus = [\"ToDo\",\"Doing\", \"Done\"]\n   7     rteam = [\"Sailor\", \"Corsair\", \"Captain\"]\n   8     ",
      "suggested_fix": "Удалите секреты из кода, храните в переменных окружения/secret manager, выполните немедленную ротировку скомпрометированных ключей.",
      "llm_response": "# LLM FIX START\nimport os\n\nSECRET_KEY = os.getenv('SECRET_KEY', 'CTF-2#SecretKey')\nJWT_KEY = os.getenv('JWT_KEY', 'CTF-2#PirateLabel')\ndesteam = [\"External order\", \"Internal order\", \"Technical order\"]\ntstatus = [\"ToDo\",\"Doing\", \"Done\"]\nrteam = [\"Sailor\", \"Corsair\", \"Captain\"]\n# LLM FIX END",
      "model_used": "gpt-5-mini"
    },
    {
      "vulnerability_info": {
        "type": "Хардкоденные секреты и пароли в коде",
        "cwe": "CWE-798 Use of Hard-coded Credentials",
        "file": "/taskstate_2/tsapp/sconfig.py",
        "location": "4-4",
        "severity": "MEDIUM"
      },
      "original_code": "   1     import os\n   2     \n   3     SECRET_KEY = 'CTF-2#SecretKey'\n   4 >>> JWT_KEY = 'CTF-2#PirateLabel'\n   5     desteam = [\"External order\", \"Internal order\", \"Technical order\"]\n   6     tstatus = [\"ToDo\",\"Doing\", \"Done\"]\n   7     rteam = [\"Sailor\", \"Corsair\", \"Captain\"]\n   8     \n   9     ",
      "suggested_fix": "Удалите секреты из кода, храните в переменных окружения/secret manager, выполните немедленную ротировку скомпрометированных ключей.",
      "llm_response": "# LLM FIX START\nimport os\n\nSECRET_KEY = os.getenv('SECRET_KEY', 'CTF-2#SecretKey')\nJWT_KEY = os.getenv('JWT_KEY', 'CTF-2#PirateLabel')\ndesteam = [\"External order\", \"Internal order\", \"Technical order\"]\ntstatus = [\"ToDo\",\"Doing\", \"Done\"]\nrteam = [\"Sailor\", \"Corsair\", \"Captain\"]\n# LLM FIX END",
      "model_used": "gpt-5-mini"
    }
  ]
}