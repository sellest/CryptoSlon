{
  "version": "2.1.0",
  "runs": [
    {
      "invocations": [
        {
          "executionSuccessful": true,
          "toolExecutionNotifications": []
        }
      ],
      "results": [
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/app.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 18,
                  "endLine": 17,
                  "snippet": {
                    "text": "if __name__ == '__main__':\n    with app.app_context():\n        db.create_all()\n        app.run()"
                  },
                  "startColumn": 1,
                  "startLine": 14
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что __name__ не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/func.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 19,
                  "endLine": 25,
                  "snippet": {
                    "text": "    if rid == 2:\n        res = True"
                  },
                  "startColumn": 5,
                  "startLine": 24
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/func.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 23,
                  "endLine": 28,
                  "snippet": {
                    "text": "    if rid == 1:\n        if task.private == False or (task.uid1 == uid and task.private == True):\n            res = True"
                  },
                  "startColumn": 5,
                  "startLine": 26
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/func.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 23,
                  "endLine": 31,
                  "snippet": {
                    "text": "    if rid == 0:\n        if task.uid1 == uid:\n            res = True"
                  },
                  "startColumn": 5,
                  "startLine": 29
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/func.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 23,
                  "endLine": 31,
                  "snippet": {
                    "text": "        if task.uid1 == uid:\n            res = True"
                  },
                  "startColumn": 9,
                  "startLine": 30
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что task.uid1 не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/func.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 61,
                  "endLine": 37,
                  "snippet": {
                    "text": "    token = jwt.encode(jwt_data, JWT_KEY, algorithm=\"HS256\")"
                  },
                  "startColumn": 13,
                  "startLine": 37
                }
              }
            }
          ],
          "message": {
            "text": "CWE-640 (эвристика): jwt.encode() без поля exp в payload. Добавьте 'exp' и проверяйте истечение срока.\n"
          },
          "properties": {},
          "ruleId": "rules.jwt-encode-without-exp-claim"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 45,
                  "endLine": 80,
                  "snippet": {
                    "text": "    if request.method == \"POST\":\n        ulogin = request.form['login']\n        upassword = request.form['password']\n        user = TS_User.query.filter_by(login=ulogin).first()\n        if user and check_password_hash(user.password, upassword):\n            login_user(user)\n            resp = make_response(redirect(url_for('myprofile')))\n            resp.set_cookie('rid', str(user.rid))\n            app.logger.info('[AUTH] [LOGIN] [Succeess] User:<%s>, role: <%s>', current_user.login, current_user.rid)\n            return resp\n        else:\n            flash('Login or password incorrect')\n            app.logger.warning('[AUTH] [LOGIN] [Failed] User:<%s> Password:<%s>', ulogin, upassword)\n            return redirect(url_for('login'))\n    else:\n        return render_template(\"login.html\")"
                  },
                  "startColumn": 5,
                  "startLine": 65
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что request.method не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 101,
                  "endLine": 77,
                  "snippet": {
                    "text": "            app.logger.warning('[AUTH] [LOGIN] [Failed] User:<%s> Password:<%s>', ulogin, upassword)"
                  },
                  "startColumn": 13,
                  "startLine": 77
                }
              }
            }
          ],
          "message": {
            "text": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n"
          },
          "properties": {},
          "ruleId": "rules.logging-passwords"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 101,
                  "endLine": 77,
                  "snippet": {
                    "text": "            app.logger.warning('[AUTH] [LOGIN] [Failed] User:<%s> Password:<%s>', ulogin, upassword)"
                  },
                  "startColumn": 17,
                  "startLine": 77
                }
              }
            }
          ],
          "message": {
            "text": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n"
          },
          "properties": {},
          "ruleId": "rules.logging-passwords"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 43,
                  "endLine": 117,
                  "snippet": {
                    "text": "    if request.method == \"POST\":\n        ulogin=request.form['login']\n        upassword=request.form['password']\n        if not(ulogin or upassword):\n            flash('Please, fill fileds: login, password')\n            return redirect('/reg')\n        elif not(TS_User.query.filter_by(login=ulogin).first()) and ulogin and upassword:\n            user = TS_User(login=ulogin, password=generate_password_hash(upassword), email=request.form['email'], rid=0, token=\"\")\n            try:\n                db.session.add(user)\n                db.session.commit()\n                app.logger.info('[AUTH] [REG] [Succeess] User:<%s>', ulogin)\n                return redirect('/login')\n            except:\n                app.logger.error('[AUTH] [REG] [Failed] User:<%s>. Error DB insert.', ulogin)\n                flash('Error DB insert')\n                return redirect('/reg')\n        else:\n            app.logger.warning('[AUTH] [REG] [Failed] Please, enter other login or not null login or not null password')\n            flash('Please, enter other login or not null login or not null password')\n            return redirect('/reg')\n    else:\n        return render_template(\"reg.html\")"
                  },
                  "startColumn": 5,
                  "startLine": 95
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что request.method не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 121,
                  "endLine": 113,
                  "snippet": {
                    "text": "            app.logger.warning('[AUTH] [REG] [Failed] Please, enter other login or not null login or not null password')"
                  },
                  "startColumn": 13,
                  "startLine": 113
                }
              }
            }
          ],
          "message": {
            "text": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n"
          },
          "properties": {},
          "ruleId": "rules.logging-passwords"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 121,
                  "endLine": 113,
                  "snippet": {
                    "text": "            app.logger.warning('[AUTH] [REG] [Failed] Please, enter other login or not null login or not null password')"
                  },
                  "startColumn": 17,
                  "startLine": 113
                }
              }
            }
          ],
          "message": {
            "text": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n"
          },
          "properties": {},
          "ruleId": "rules.logging-passwords"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 61,
                  "endLine": 196,
                  "snippet": {
                    "text": "@app.route('/passrec', methods=['POST','GET'])\ndef passrec():\n    p = 0\n    token = \"\"\n    if len(request.args) > 0:\n        if request.args.get('login'):\n            ulogin = request.args.get('login')\n            user = TS_User.query.filter(TS_User.login==ulogin).first()\n            if user:\n                token = jwt_encod(user)\n                user.token = token\n                try:\n                    db.session.add(user)\n                    db.session.commit()\n                    flash('Token created...')\n                    app.logger.info('[AUTH] [passrec] [Succeess] For User:<%s> token <%s> created', ulogin, token)\n                except:\n                    app.logger.error('[AUTH] [passrec] [Failed] User:<%s>. Error DB insert.', ulogin)\n                    flash('Error DB insert')\n            else:\n                flash('Login incorrect')\n                app.logger.warning('[AUTH] [passrec] [Failed] User:<%s> does not exist', ulogin)\n        if request.args.get('token') and not request.args.get('password'):\n            token = request.args.get('token')\n            try:\n                token_data = jwt_decod(token)\n                app.logger.info('[AUTH] [passrec] [Succeess] For token: <%s> exist data: <%s>', token, token_data)\n            except:\n                p = 0\n                token_data = \"\"\n                flash('Token incorrect')\n                app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect', token)\n            if token_data:\n                uid = token_data[\"id\"]\n                user = TS_User.query.filter(TS_User.id==uid).first()\n                if user:\n                    p = 1\n                    app.logger.info('[AUTH] [passrec] [Succeess] For token: <%s> exist user: <%s>', token, user.login)\n                    return render_template(\"recpass.html\", p=p, token=token)\n                else:\n                    p = 0\n                    flash('Token incorrect')\n                    app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect. Not exist user.', token)\n            else:\n                p = 0\n                app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect. Not exist data.', token)\n                flash('Token incorrect')\n        if request.args.get('token') and request.args.get('password'):\n            token = request.args.get('token')\n            try:\n                token_data = jwt_decod(token)\n            except:\n                p = 0\n                token_data = \"\"\n                app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect. Not exist data. Password: <%s>', token, request.args.get('password'))\n                flash('Token incorrect')\n            if token_data:\n                uid = token_data[\"id\"]\n                user = TS_User.query.filter(TS_User.id==uid).first()\n                if user:\n                    p = 0\n                    user.password = generate_password_hash(request.args.get('password'))\n                    user.token = \"\"\n                    try:\n                        db.session.add(user)\n                        db.session.commit()\n                        app.logger.info('[AUTH] [passrec] [Succeess] For User:<%s> change password', user.login)\n                    except:\n                        app.logger.error('[AUTH] [passrec] [Failed] User:<%s>. Error DB insert.', user.login)\n                        flash('Error DB insert')\n            else:\n                p = 0\n                flash('Token incorrect')\n                app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect. Not exist data.', token)\n    else:\n        pass\n    return render_template(\"recpass.html\", p=p, token=token)"
                  },
                  "startColumn": 1,
                  "startLine": 120
                }
              }
            }
          ],
          "message": {
            "text": "CWE-640 (эвристика): маршрут допускает метод GET и меняет пароль. Смена пароля по GET небезопасна. Используйте POST и проверяйте токен/TTL/одноразовость.\n"
          },
          "properties": {},
          "ruleId": "rules.flask-passrec-get-route-password-change"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 153,
                  "endLine": 174,
                  "snippet": {
                    "text": "                app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect. Not exist data. Password: <%s>', token, request.args.get('password'))"
                  },
                  "startColumn": 17,
                  "startLine": 174
                }
              }
            }
          ],
          "message": {
            "text": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n"
          },
          "properties": {},
          "ruleId": "rules.logging-passwords"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 153,
                  "endLine": 174,
                  "snippet": {
                    "text": "                app.logger.error('[AUTH] [passrec] [Failed] Token: <%s> incorrect. Not exist data. Password: <%s>', token, request.args.get('password'))"
                  },
                  "startColumn": 21,
                  "startLine": 174
                }
              }
            }
          ],
          "message": {
            "text": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n"
          },
          "properties": {},
          "ruleId": "rules.logging-passwords"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 113,
                  "endLine": 186,
                  "snippet": {
                    "text": "                        app.logger.info('[AUTH] [passrec] [Succeess] For User:<%s> change password', user.login)"
                  },
                  "startColumn": 25,
                  "startLine": 186
                }
              }
            }
          ],
          "message": {
            "text": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n"
          },
          "properties": {},
          "ruleId": "rules.logging-passwords"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 113,
                  "endLine": 186,
                  "snippet": {
                    "text": "                        app.logger.info('[AUTH] [passrec] [Succeess] For User:<%s> change password', user.login)"
                  },
                  "startColumn": 29,
                  "startLine": 186
                }
              }
            }
          ],
          "message": {
            "text": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n"
          },
          "properties": {},
          "ruleId": "rules.logging-passwords"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 34,
                  "endLine": 202,
                  "snippet": {
                    "text": "    if response.status_code == 401:\n        return redirect('/login')"
                  },
                  "startColumn": 5,
                  "startLine": 201
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что response.status_code не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 43,
                  "endLine": 232,
                  "snippet": {
                    "text": "    if request.method == \"POST\":\n        if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):\n            task = TS_Task(did=int(request.form['did']), title=request.form['title'], description=request.form['description'], private=eval(request.form['private']), uid1=current_user.id, uid2=-1)\n            try:\n                db.session.add(task)\n                db.session.commit()\n                app.logger.info('[FUNC] [/taskcreate] [Succeess] User:<%s> Title:<%s> Description:<%s>',current_user.login, task.title, task.description)\n                return redirect(url_for('mytask'))\n            except:\n                app.logger.error('[FUNC] [/taskcreate] [Failed] User:<%s> Error DB insert',current_user.login)\n                flash('Error DB insert')\n                return redirect(url_for('mytask'))\n        else:\n            flash('Please, enter all rewuired data!')\n            return redirect(url_for('mytask'))\n    else:\n        return redirect(url_for('mytask'))"
                  },
                  "startColumn": 5,
                  "startLine": 216
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что request.method не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 124,
                  "endLine": 217,
                  "snippet": {
                    "text": "        if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):"
                  },
                  "startColumn": 95,
                  "startLine": 217
                }
              }
            }
          ],
          "message": {
            "text": "Возможная инъекция кода: eval/exec с пользовательским вводом. Никогда не передавайте значения из request.* в eval/exec.\n"
          },
          "properties": {},
          "ruleId": "rules.python-eval-exec-taint"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 165,
                  "endLine": 218,
                  "snippet": {
                    "text": "            task = TS_Task(did=int(request.form['did']), title=request.form['title'], description=request.form['description'], private=eval(request.form['private']), uid1=current_user.id, uid2=-1)"
                  },
                  "startColumn": 136,
                  "startLine": 218
                }
              }
            }
          ],
          "message": {
            "text": "Возможная инъекция кода: eval/exec с пользовательским вводом. Никогда не передавайте значения из request.* в eval/exec.\n"
          },
          "properties": {},
          "ruleId": "rules.python-eval-exec-taint"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 81,
                  "endLine": 275,
                  "snippet": {
                    "text": "        if request.method == \"POST\":\n            if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):\n                task.title = request.form['title']\n                task.description = request.form['description']\n                task.did = int(request.form['did'])\n                task.private = eval(request.form['private'])\n                try:\n                    db.session.commit()\n                    app.logger.info('[FUNC] [/task/edit] [Succeess] User:<%s> Edit task: <%s> owner:<%s>', current_user.login, task.tid, task.TS_User.login)\n                    return redirect(url_for('mytask'))\n                except:\n                    app.logger.error('[FUNC] [/task/edit] [Failed] User:<%s> Edit task: <%s> owner:<%s>. Error DB insert/', current_user.login, task.tid, task.TS_User.login)\n                    flash('Error DB insert')\n                    return redirect('/task/' + str(tid) + '/edit')\n            else:\n                flash('Please, enter all rewuired data!')\n                return redirect('/task/' + str(tid) + '/edit')\n        else:\n            return render_template(\"task_edit.html\", task=task, desteam=desteam)"
                  },
                  "startColumn": 9,
                  "startLine": 257
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что request.method не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 128,
                  "endLine": 258,
                  "snippet": {
                    "text": "            if (len(request.form['title']) > 2 and type(int(request.form['did'])) == int and type(eval(request.form['private'])) == bool):"
                  },
                  "startColumn": 99,
                  "startLine": 258
                }
              }
            }
          ],
          "message": {
            "text": "Возможная инъекция кода: eval/exec с пользовательским вводом. Никогда не передавайте значения из request.* в eval/exec.\n"
          },
          "properties": {},
          "ruleId": "rules.python-eval-exec-taint"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 61,
                  "endLine": 262,
                  "snippet": {
                    "text": "                task.private = eval(request.form['private'])"
                  },
                  "startColumn": 32,
                  "startLine": 262
                }
              }
            }
          ],
          "message": {
            "text": "Возможная инъекция кода: eval/exec с пользовательским вводом. Никогда не передавайте значения из request.* в eval/exec.\n"
          },
          "properties": {},
          "ruleId": "rules.python-eval-exec-taint"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 92,
                  "endLine": 304,
                  "snippet": {
                    "text": "    if rid == 2:\n        tasks = TS_Task.query.order_by(TS_Task.tid.desc()).paginate(page=page, per_page=10)"
                  },
                  "startColumn": 5,
                  "startLine": 303
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 188,
                  "endLine": 306,
                  "snippet": {
                    "text": "    if rid == 1:\n        tasks = TS_Task.query.filter(or_(TS_Task.private==False, and_(TS_Task.uid1==current_user.id, TS_Task.private==True))).order_by(TS_Task.tid.desc()).paginate(page=page, per_page=10)"
                  },
                  "startColumn": 5,
                  "startLine": 305
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 130,
                  "endLine": 308,
                  "snippet": {
                    "text": "    if rid == 0:\n        tasks = TS_Task.query.filter(TS_Task.uid1==current_user.id).order_by(TS_Task.tid.desc()).paginate(page=page, per_page=10)"
                  },
                  "startColumn": 5,
                  "startLine": 307
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 110,
                  "endLine": 399,
                  "snippet": {
                    "text": "        if rid == 2:\n            tasks = TS_Task.query.filter(TS_Task.title.contains(tsearch)).order_by(TS_Task.date.desc()).all()"
                  },
                  "startColumn": 9,
                  "startLine": 398
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 205,
                  "endLine": 401,
                  "snippet": {
                    "text": "        if rid == 1:\n            tasks = TS_Task.query.filter(and_(or_(TS_Task.private==False, and_(TS_Task.uid1==current_user.id, TS_Task.private==True)), TS_Task.title.contains(tsearch))).order_by(TS_Task.date.desc()).all()"
                  },
                  "startColumn": 9,
                  "startLine": 400
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 147,
                  "endLine": 403,
                  "snippet": {
                    "text": "        if rid == 0:\n            tasks = TS_Task.query.filter(and_(TS_Task.uid1==current_user.id, TS_Task.title.contains(tsearch))).order_by(TS_Task.date.desc()).all()"
                  },
                  "startColumn": 9,
                  "startLine": 402
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 120,
                  "endLine": 405,
                  "snippet": {
                    "text": "        return render_template(\"searchlist.html\", tasks=tasks, tstatus=tstatus, tsearch=render_template_string(tsearch))"
                  },
                  "startColumn": 89,
                  "startLine": 405
                }
              }
            }
          ],
          "message": {
            "text": "Возможная SSTI (CWE-1336): пользовательский ввод попадает в render_template_string(). Проверьте, что строка не формируется из request.args/request.form/request.values/JSON.\n"
          },
          "properties": {},
          "ruleId": "rules.flask-ssti-render-template-string-taint"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 46,
                  "endLine": 429,
                  "snippet": {
                    "text": "    if rid == 2:\n        users = TS_User.query.order_by(TS_User.id.desc()).paginate(page=page, per_page=10)\n        pagination = Pagination(page=page, total=users.total, record_name='users')\n        app.logger.info('[FUNC] [/adminpanel] [Succeess] User:<%s> Role:<%d>/<%d> Read users: <%d>', current_user.login, current_user.rid, rid, len(users.items))\n        return render_template(\"admpanel.html\", users=users, rteam=rteam, reg=reg, pagination=pagination)\n    else:\n        users = TS_User.query.filter(TS_User.rid==2).order_by(TS_User.id.desc()).all()\n        if len(users) == 0:\n            reg = 1\n            app.logger.info('[FUNC] [/adminpanel] [Succeess] User:<%s> Role:<%d>/<%d> Start initialization >> Registration of a new captain for the service', current_user.login, current_user.rid, rid)\n            return render_template(\"admpanel.html\", users=users, rteam=rteam, reg=reg)\n        else:\n            app.logger.warning('[FUNC] [/adminpanel] [Failed] User:<%s> Access is denied', current_user.login)\n            return redirect(url_for('index'))"
                  },
                  "startColumn": 5,
                  "startLine": 416
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 46,
                  "endLine": 429,
                  "snippet": {
                    "text": "        if len(users) == 0:\n            reg = 1\n            app.logger.info('[FUNC] [/adminpanel] [Succeess] User:<%s> Role:<%d>/<%d> Start initialization >> Registration of a new captain for the service', current_user.login, current_user.rid, rid)\n            return render_template(\"admpanel.html\", users=users, rteam=rteam, reg=reg)\n        else:\n            app.logger.warning('[FUNC] [/adminpanel] [Failed] User:<%s> Access is denied', current_user.login)\n            return redirect(url_for('index'))"
                  },
                  "startColumn": 9,
                  "startLine": 423
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что len(users) не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 35,
                  "endLine": 451,
                  "snippet": {
                    "text": "    if rid == 2:\n        user = TS_User.query.filter(TS_User.id==id).order_by(TS_User.date.desc()).first()\n        if user:\n            if user.rid != 2:\n                user.rid += 1\n                try:\n                    db.session.commit()\n                    app.logger.info('[FUNC] [/adminpanel/nrteam] [Succeess] User:<%s> Role:<%d>/<%d> For user:<%s> upd role to:<%d>', current_user.login, current_user.rid, rid, user.login, user.rid)\n                except:\n                    app.logger.error('[FUNC] [/adminpanel/nrteam] [Succeess] User:<%s> Role:<%d> For user:<%s> upd role to:<%d>. Error DB delete!', current_user.login, current_user.rid, user.login, user.rid)\n                    return \"Error DB delete!\"\n        else:\n            app.logger.warning('[FUNC] [/adminpanel/nrteam] [Failed] User:<%s> Role:<%d> For user:<%s> upd role to:<%d> User not found!', current_user.login, current_user.rid, user.login, user.rid)\n        return redirect(url_for('adm'))\n    else:\n        redirect(url_for('index'))"
                  },
                  "startColumn": 5,
                  "startLine": 436
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 35,
                  "endLine": 473,
                  "snippet": {
                    "text": "    if rid == 2:\n        user = TS_User.query.filter(TS_User.id==id).order_by(TS_User.date.desc()).first()\n        if user:\n            if user.rid != 0:\n                user.rid -= 1\n                try:\n                    db.session.commit()\n                    app.logger.info('[FUNC] [/adminpanel/brteam] [Succeess] User:<%s> Role:<%d>/<%d> For user:<%s> upd role to:<%d>', current_user.login, current_user.rid, rid, user.login, user.rid)\n                except:\n                    app.logger.error('[FUNC] [/adminpanel/brteam] [Succeess] User:<%s> Role:<%d> For user:<%s> upd role to:<%d>. Error DB delete!', current_user.login, current_user.rid, user.login, user.rid)\n                    return \"Error DB delete!\"\n        else:\n            app.logger.warning('[FUNC] [/adminpanel/brteam] [Failed] User:<%s> Role:<%d> For user:<%s> upd role to:<%d> User not found!', current_user.login, current_user.rid, user.login, user.rid)\n        return redirect(url_for('adm'))\n    else:\n        redirect(url_for('index'))"
                  },
                  "startColumn": 5,
                  "startLine": 458
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что rid не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 35,
                  "endLine": 501,
                  "snippet": {
                    "text": "    if request.method == \"POST\":\n        ulogin=request.form['login']\n        upassword=request.form['password']\n        if not(ulogin or upassword):\n            flash('Please, fill fileds: login, password')\n            return redirect(url_for('adm'))\n        elif not(TS_User.query.filter_by(login=ulogin).first()) and ulogin and upassword:\n            user = TS_User(login=ulogin, password=generate_password_hash(upassword), email=request.form['email'], rid=2, token=\"\")\n            try:\n                db.session.add(user)\n                db.session.commit()\n                app.logger.info('[AUTH] [admreg] [Succeess] User:<%s> Role:<%d> registartion captain:<%s>',current_user.login, current_user.rid, ulogin)\n                return redirect(url_for('adm'))\n            except:\n                app.logger.error('[AUTH] [admreg] [Failed] User:<%s>. Error DB insert.', ulogin)\n                flash('Error DB insert')\n                return redirect(url_for('adm'))\n        else:\n            app.logger.warning('[AUTH] [admreg] [Failed] Please, enter other login or not null login or not null password')\n            flash('Please, enter other login or not null login or not null password')\n            return redirect(url_for('adm'))\n    else:\n        redirect(url_for('index'))"
                  },
                  "startColumn": 5,
                  "startLine": 479
                }
              }
            }
          ],
          "message": {
            "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что request.method не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
          },
          "properties": {},
          "ruleId": "rules.flask-privilege-magic-role-check"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 124,
                  "endLine": 497,
                  "snippet": {
                    "text": "            app.logger.warning('[AUTH] [admreg] [Failed] Please, enter other login or not null login or not null password')"
                  },
                  "startColumn": 13,
                  "startLine": 497
                }
              }
            }
          ],
          "message": {
            "text": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n"
          },
          "properties": {},
          "ruleId": "rules.logging-passwords"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/routes.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 124,
                  "endLine": 497,
                  "snippet": {
                    "text": "            app.logger.warning('[AUTH] [admreg] [Failed] Please, enter other login or not null login or not null password')"
                  },
                  "startColumn": 17,
                  "startLine": 497
                }
              }
            }
          ],
          "message": {
            "text": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n"
          },
          "properties": {},
          "ruleId": "rules.logging-passwords"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/sconfig.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 31,
                  "endLine": 3,
                  "snippet": {
                    "text": "SECRET_KEY = 'CTF-2#SecretKey'"
                  },
                  "startColumn": 1,
                  "startLine": 3
                }
              }
            }
          ],
          "message": {
            "text": "Захардкоженный секрет (CWE-798). Храните SECRET_KEY/JWT_KEY в переменных окружения или в секрет-хранилище.\n"
          },
          "properties": {},
          "ruleId": "rules.flask-hardcoded-secrets"
        },
        {
          "fingerprints": {
            "matchBasedId/v1": "requires login"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/Users/izelikson/python/CryptoSlon/SAST/code_for_sast/taskstate_3/tsapp/sconfig.py",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "endColumn": 30,
                  "endLine": 4,
                  "snippet": {
                    "text": "JWT_KEY = 'CTF-2#PirateLabel'"
                  },
                  "startColumn": 1,
                  "startLine": 4
                }
              }
            }
          ],
          "message": {
            "text": "Захардкоженный секрет (CWE-798). Храните SECRET_KEY/JWT_KEY в переменных окружения или в секрет-хранилище.\n"
          },
          "properties": {},
          "ruleId": "rules.flask-hardcoded-secrets"
        }
      ],
      "tool": {
        "driver": {
          "name": "Semgrep OSS",
          "rules": [
            {
              "defaultConfiguration": {
                "level": "warning"
              },
              "fullDescription": {
                "text": "Захардкоженный секрет (CWE-798). Храните SECRET_KEY/JWT_KEY в переменных окружения или в секрет-хранилище.\n"
              },
              "help": {
                "markdown": "Захардкоженный секрет (CWE-798). Храните SECRET_KEY/JWT_KEY в переменных окружения или в секрет-хранилище.\n",
                "text": "Захардкоженный секрет (CWE-798). Храните SECRET_KEY/JWT_KEY в переменных окружения или в секрет-хранилище.\n"
              },
              "id": "rules.flask-hardcoded-secrets",
              "name": "rules.flask-hardcoded-secrets",
              "properties": {
                "precision": "very-high",
                "tags": []
              },
              "shortDescription": {
                "text": "Semgrep Finding: rules.flask-hardcoded-secrets"
              }
            },
            {
              "defaultConfiguration": {
                "level": "warning"
              },
              "fullDescription": {
                "text": "CWE-640 (эвристика): маршрут допускает метод GET и меняет пароль. Смена пароля по GET небезопасна. Используйте POST и проверяйте токен/TTL/одноразовость.\n"
              },
              "help": {
                "markdown": "CWE-640 (эвристика): маршрут допускает метод GET и меняет пароль. Смена пароля по GET небезопасна. Используйте POST и проверяйте токен/TTL/одноразовость.\n",
                "text": "CWE-640 (эвристика): маршрут допускает метод GET и меняет пароль. Смена пароля по GET небезопасна. Используйте POST и проверяйте токен/TTL/одноразовость.\n"
              },
              "id": "rules.flask-passrec-get-route-password-change",
              "name": "rules.flask-passrec-get-route-password-change",
              "properties": {
                "precision": "very-high",
                "tags": []
              },
              "shortDescription": {
                "text": "Semgrep Finding: rules.flask-passrec-get-route-password-change"
              }
            },
            {
              "defaultConfiguration": {
                "level": "error"
              },
              "fullDescription": {
                "text": "CWE-640: Пароль берётся из URL (request.args). Пароли нельзя передавать через query string — используйте POST/JSON тело и защищайте CSRF/TTL/одноразовость токенов.\n"
              },
              "help": {
                "markdown": "CWE-640: Пароль берётся из URL (request.args). Пароли нельзя передавать через query string — используйте POST/JSON тело и защищайте CSRF/TTL/одноразовость токенов.\n",
                "text": "CWE-640: Пароль берётся из URL (request.args). Пароли нельзя передавать через query string — используйте POST/JSON тело и защищайте CSRF/TTL/одноразовость токенов.\n"
              },
              "id": "rules.flask-passrec-password-in-get",
              "name": "rules.flask-passrec-password-in-get",
              "properties": {
                "precision": "very-high",
                "tags": []
              },
              "shortDescription": {
                "text": "Semgrep Finding: rules.flask-passrec-password-in-get"
              }
            },
            {
              "defaultConfiguration": {
                "level": "warning"
              },
              "fullDescription": {
                "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что $RID не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
              },
              "help": {
                "markdown": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что $RID не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n",
                "text": "Эвристика CWE-269: жёсткая проверка роли по «магическому числу/строке». Убедитесь, что $RID не приходит из cookie, и что проверка выполняется на серверной роли (current_user / серверная сессия).\n"
              },
              "id": "rules.flask-privilege-magic-role-check",
              "name": "rules.flask-privilege-magic-role-check",
              "properties": {
                "precision": "very-high",
                "tags": []
              },
              "shortDescription": {
                "text": "Semgrep Finding: rules.flask-privilege-magic-role-check"
              }
            },
            {
              "defaultConfiguration": {
                "level": "error"
              },
              "fullDescription": {
                "text": "Возможная проблема управления привилегиями (CWE-269): роль/уровень доступа читается из клиентского cookie. Не доверяйте request.cookies для ACL. Храните роль в серверной сессии/БД (current_user), а не в cookie.\n"
              },
              "help": {
                "markdown": "Возможная проблема управления привилегиями (CWE-269): роль/уровень доступа читается из клиентского cookie. Не доверяйте request.cookies для ACL. Храните роль в серверной сессии/БД (current_user), а не в cookie.\n",
                "text": "Возможная проблема управления привилегиями (CWE-269): роль/уровень доступа читается из клиентского cookie. Не доверяйте request.cookies для ACL. Храните роль в серверной сессии/БД (current_user), а не в cookie.\n"
              },
              "id": "rules.flask-privilege-role-from-cookie",
              "name": "rules.flask-privilege-role-from-cookie",
              "properties": {
                "precision": "very-high",
                "tags": []
              },
              "shortDescription": {
                "text": "Semgrep Finding: rules.flask-privilege-role-from-cookie"
              }
            },
            {
              "defaultConfiguration": {
                "level": "error"
              },
              "fullDescription": {
                "text": "Возможная SSTI (CWE-1336): пользовательский ввод попадает в render_template_string(). Проверьте, что строка не формируется из request.args/request.form/request.values/JSON.\n"
              },
              "help": {
                "markdown": "Возможная SSTI (CWE-1336): пользовательский ввод попадает в render_template_string(). Проверьте, что строка не формируется из request.args/request.form/request.values/JSON.\n",
                "text": "Возможная SSTI (CWE-1336): пользовательский ввод попадает в render_template_string(). Проверьте, что строка не формируется из request.args/request.form/request.values/JSON.\n"
              },
              "id": "rules.flask-ssti-render-template-string-taint",
              "name": "rules.flask-ssti-render-template-string-taint",
              "properties": {
                "precision": "very-high",
                "tags": []
              },
              "shortDescription": {
                "text": "Semgrep Finding: rules.flask-ssti-render-template-string-taint"
              }
            },
            {
              "defaultConfiguration": {
                "level": "note"
              },
              "fullDescription": {
                "text": "Эвристика SSTI/XSS: вывод помечен как |safe. Убедитесь, что данные не из пользовательского ввода, либо используйте экранирование.\n"
              },
              "help": {
                "markdown": "Эвристика SSTI/XSS: вывод помечен как |safe. Убедитесь, что данные не из пользовательского ввода, либо используйте экранирование.\n",
                "text": "Эвристика SSTI/XSS: вывод помечен как |safe. Убедитесь, что данные не из пользовательского ввода, либо используйте экранирование.\n"
              },
              "id": "rules.jinja-safe-filter-user-input",
              "name": "rules.jinja-safe-filter-user-input",
              "properties": {
                "precision": "very-high",
                "tags": []
              },
              "shortDescription": {
                "text": "Semgrep Finding: rules.jinja-safe-filter-user-input"
              }
            },
            {
              "defaultConfiguration": {
                "level": "warning"
              },
              "fullDescription": {
                "text": "CWE-640 (эвристика): jwt.encode() без поля exp в payload. Добавьте 'exp' и проверяйте истечение срока.\n"
              },
              "help": {
                "markdown": "CWE-640 (эвристика): jwt.encode() без поля exp в payload. Добавьте 'exp' и проверяйте истечение срока.\n",
                "text": "CWE-640 (эвристика): jwt.encode() без поля exp в payload. Добавьте 'exp' и проверяйте истечение срока.\n"
              },
              "id": "rules.jwt-encode-without-exp-claim",
              "name": "rules.jwt-encode-without-exp-claim",
              "properties": {
                "precision": "very-high",
                "tags": []
              },
              "shortDescription": {
                "text": "Semgrep Finding: rules.jwt-encode-without-exp-claim"
              }
            },
            {
              "defaultConfiguration": {
                "level": "error"
              },
              "fullDescription": {
                "text": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n"
              },
              "help": {
                "markdown": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n",
                "text": "Утечка чувствительных данных через логи (CWE-532): строка логирования содержит 'password'. Не логируйте пароли/секреты; маскируйте значения.\n"
              },
              "id": "rules.logging-passwords",
              "name": "rules.logging-passwords",
              "properties": {
                "precision": "very-high",
                "tags": []
              },
              "shortDescription": {
                "text": "Semgrep Finding: rules.logging-passwords"
              }
            },
            {
              "defaultConfiguration": {
                "level": "error"
              },
              "fullDescription": {
                "text": "Возможная инъекция кода: eval/exec с пользовательским вводом. Никогда не передавайте значения из request.* в eval/exec.\n"
              },
              "help": {
                "markdown": "Возможная инъекция кода: eval/exec с пользовательским вводом. Никогда не передавайте значения из request.* в eval/exec.\n",
                "text": "Возможная инъекция кода: eval/exec с пользовательским вводом. Никогда не передавайте значения из request.* в eval/exec.\n"
              },
              "id": "rules.python-eval-exec-taint",
              "name": "rules.python-eval-exec-taint",
              "properties": {
                "precision": "very-high",
                "tags": []
              },
              "shortDescription": {
                "text": "Semgrep Finding: rules.python-eval-exec-taint"
              }
            }
          ],
          "semanticVersion": "1.132.0"
        }
      }
    }
  ],
  "$schema": "https://docs.oasis-open.org/sarif/sarif/v2.1.0/os/schemas/sarif-schema-2.1.0.json"
}